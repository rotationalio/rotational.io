<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=twitter:card content="summary"><meta property="og:image" content="https://rotational.io/img/blog/2021-04-06-a-distributed-systems-maze/maze.jpg"><meta name=twitter:image content="https://rotational.io/img/blog/2021-04-06-a-distributed-systems-maze/maze.jpg"><meta property="og:title" content="A Distributed Systems Maze"><meta name=twitter:title content="A Distributed Systems Maze"><meta property="og:description" content="Distributed systems jargon can feel like a maze that your constantly lost in. In this post we try to see our way clear with a maze metaphor to understand why coordination is necessary, and difficult."><meta name=twitter:description content="Distributed systems jargon can feel like a maze that your constantly lost in. In this post we try to see our way clear with a maze metaphor to understand why coordination is necessary, and difficult."><meta name=author content="Rotational Labs, LLC"><base href=https://rotational.io/><title>Rotational Labs | A Distributed Systems Maze</title><link rel="shortcut icon" href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=icon href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,600;1,700;1,800&display=swap" rel=stylesheet><link rel=stylesheet href=https://rotational.io/output.css media=screen><script async src="https://www.googletagmanager.com/gtag/js?id=G-2FKX6CWJHW"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2FKX6CWJHW")</script><script src=https://kit.fontawesome.com/2c36e9b7b1.js crossorigin=anonymous></script>
<script src="https://www.google.com/recaptcha/enterprise.js?render="></script>
<script>grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute("6Ld5O3kiAAAAAJU0z0h81X1RxEMHyoROe6KWe_vk",{action:"homepage"}).then(function(){})})</script></head><body class="bg-hexagon bg-center bg-contain"><div class="sm:pt-5 pb-6 relative bg-[#1D65A6]"><nav class="relative max-w-7xl mx-auto flex items-center justify-between text-white px-4 sm:px-6 z-10" aria-label=Global><a href=/ class=pt-3><img src=img/logo.png alt="Rotational Lab logo" class="h-14 w-auto sm:h-14"></a><div class=topnav id=myTopnav><a href=/ensign/>Ensign</a>
<a href=/services/>Services</a>
<a href=/opensource/>Open Source</a>
<a href=/blog/>Blog</a>
<a href=/about/>About</a>
<a href=/contact/>Contact Us</a>
<a class="icon mt-4" onclick=openMobNav()><i class="fa fa-bars"></i></a></div></nav></div><main><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class=mt-14><div class=blog-img><img src=https://rotational.io/img/blog/2021-04-06-a-distributed-systems-maze/maze.jpg alt="A Distributed Systems Maze" class="mx-auto object-cover"></div><div class=mt-8><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl text-center" data-blog-title="A Distributed Systems Maze"><b class=text-[#1D65A6]>A</b>
Distributed Systems Maze</h3><div class="flex justify-center items-center mt-4 mb-6"><img src=img/team/benjamin-bengfort.png alt class="border-4 border-white rounded-full h-11 drop-shadow-lg"><span class=ml-3>Benjamin Bengfort |
Tuesday, Apr 6, 2021 | Distributed Systems</span></div><article class="max-w-[800px] mx-auto prose"><p>The most exciting applications coming out these days are the ones that aim big — aspiring to reach a global audience of users across regions, languages, timezones, and data centers. Not only are they in the exhilarating position of owning planet-scale markets, they&rsquo;re poised to take on some of the most interesting data systems problems we&rsquo;ve ever seen!</p><p>Of course, it&rsquo;s easy to get lost in the maze of algorithms, protocols, and terminology related to distributed systems. It&rsquo;s a complex topic and there are a lot of good approaches, most of which leverage strategic optimizations that further confuse the underlying principles.</p><p>Most of the talented engineers and technical executives I know get lost in the details of two fundamental concepts: <strong>coordination</strong> and <strong>consistency</strong>. In this post, we&rsquo;ll take a look at distributed systems through a metaphor — a robot stuck in a maze — to illustrate why coordination is necessary (and difficult!), and what exactly creates consistency issues. A bit fanciful? Sure, but hard to forget!</p><h2 id=coordination>Coordination</h2><p>Imagine there are two robots trying to find their way through the same exact maze in two different buildings. Successfully completing the task requires both robots to leave the maze as quickly as possible and there is only one path that leads to the exit. The robots can communicate with each other and with human controllers that give commands to the robot remotely.</p><p>Let&rsquo;s make the commands purposefully simple - the human controllers can tell their robots to turn left or right, move forward or backward, or to take and send a picture from the forward facing camera. Robots can only execute one command at a time and by default, they execute the commands in the order they receive them.</p><h2 id=consistency>Consistency</h2><p>The first coordination scenario is, well, no coordination: each robot receives and obeys commands from its human controllers, but does not communicate the commands to each other. In this case, it&rsquo;s up to the human teams to both understand how many robots there are and what position each robot is in, directing their commands to each robot appropriately. In the best case, it will likely take twice as long for the robots to execute the maze - clearly, coordinating the actions of the robots is vital!</p><p>If the robots are strictly coordinated then when they receive a command from their human team they will pass the command to the other robot, then execute the command; if it receives a command from the other robot it will simply execute the command. Coordination in this scenario quickly gets out of hand: if two teams give commands to different robots simultaneously: &ldquo;turn left&rdquo; and &ldquo;move forward&rdquo;, then the first robot will turn left then move forward, while the second robot will move forward then turn left. They are now in two different positions and the more commands they get, the worse it is. It&rsquo;s unlikely in this scenario that either robot will be able to leave the maze.</p><p><img src=/img/blog/2021-04-06-a-distributed-systems-maze/2021-04-06-strict-coordination.png alt="Strict coordination inconsistency"></p><p>When the two robots end up in two different positions like this, an inconsistency has occurred. From the human controller point of view, they expected both robots to both move forward or turn left, and now when they ask for pictures from each robot, they get two different results! One way to think about coordination and consistency is the desirable property that both robots receive the commands in the same exact order so that they never end up in two different positions.</p><h2 id=stale-reads-and-non-conflicting-commands>Stale Reads and Non-Conflicting Commands</h2><p>We can try to fix the situation by only allowing one robot to receive commands from the human teams. This will ensure that the two robots do not end up in two different positions because the order the first robot receives commands will be the same order that the second robot receives them. However, this causes a lot of load on the first robot, slowing it down as it processes all the commands coming in. We could relax our coordination requirement and allow the &ldquo;take picture&rdquo; command to be executed by both robots. This scenario is often referred to as primary/backup copy in distributed systems.</p><p>Taking a picture is an interesting command because no matter what order the commands are received in, the robots will not end up in two different positions. The worst case scenario is that a robot takes a picture before it immediately moves, meaning that the human controller is looking at an old picture; e.g. the picture is stale. Another type of inconsistency is if both robots are asked for pictures but they return two different positions because they&rsquo;re in different places in their command sequence; the inconsistency is from the human perspective who may believe the robots are in different positions even though the reality is that at least one image is stale.</p><h2 id=failures-and-partitions>Failures and Partitions</h2><p>Robots are finicky things - what happens if the primary robot gets stuck or stops responding to commands? The robot has a self-repair feature and it will reboot if this happens, however for the duration that the lead robot is rebooting, the human controllers will be able to do nothing except take pictures from the back up robot! Time is ticking!</p><p>It is possible for the other robot to detect when the lead robot has failed — for example if it hasn&rsquo;t received a message after a certain time limit. At this point, the other robot can start accepting commands, and when the first robot reboots the live robot can send a list of commands to get the other robot to the same position its in.</p><h2 id=the-quorum>The Quorum</h2><p>Unfortunately, the back up robot won&rsquo;t be able to tell if the other robot has failed and is rebooting or if it has simple lost the ability to communicate with the other robot. If both robots are operating but can&rsquo;t communicate with each other one of two things will happen: either the robots will both take commands and we&rsquo;re back to the inconsistency problem, or neither robot will take action until it hears from the other, and we lose a bunch of time.</p><p>In order to make progress in the event that a single robot has failed or can&rsquo;t communicate with the other robot, we need a third robot in a third maze, in a third building. Now we can engage in quorum based decision making: as long as at least two robots can communicate with each other, there is a way for them to accept commands and make progress even if one robot can&rsquo;t communicate to the other robots or has started rebooting. If we want to protect from 2 possible robot failures of any type; we&rsquo;ll need 5 robots in 5 buildings. A description of how this works is for another blog post; but hopefully it will suffice to say that in a 3 group system, as long as two robots are able to communicate, any combination of single failures will result in all robots applying the same command.</p><h2 id=conclusion>Conclusion</h2><p>You&rsquo;re probably not in the business of coordinating a fleet of robotic maze navigators. Maybe your application enables crypto payment processing. Perhaps you&rsquo;re a popular game developer with an in-game currency exchange. Maybe you&rsquo;re the hot new privacy-first messaging app. Nevertheless, as your user base expands across the globe, sooner or later you&rsquo;ll start to feel the pains of robots in the maze.</p><p>Regardless what you&rsquo;re building, the robot maze metaphor highlights the importance of coordination in a distributed system, and how different consistency issues may be observed by users of our systems. For example, what is a transaction if not just a bunch of commands bundled together and applied as a sequence? How about eventual consistency? Maybe the robots do independent exploring and have a way to select the best location to all return to after some criteria has been reached.</p><p>I hope this post creates a mental hook to understand more complex distributed systems topics — not because everyone needs to be an expert, but so that you can build out your application the way that makes sense for <em>your</em> business.</p></article></div></div><div class="bg-[#E8EFF6] max-w-[800px] mx-auto mt-9 p-8 rounded-lg"><div class=text-center><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl"><b class=text-[#1D65A6]>About</b>
This Post</h3></div><p class="mt-4 text-base mx-auto text-center sm:mt-5 lg:mt-7 lg:text-base max-w-2xl">Distributed systems jargon can feel like a maze that your constantly lost in. In this post we try to see our way clear with a maze metaphor to understand why coordination is necessary, and difficult.</p><div class="md:flex text-center max-w-[600px] mx-auto border-t pt-6 mt-6 align-center justify-between"><div><div class="text-lg text-[#1D65A6] font-bold mb-3">Written by:</div><div class="flex items-center mt-4 mb-6"><img src=img/team/benjamin-bengfort.png alt class="border-4 border-white rounded-full h-11 drop-shadow-lg"><span class=ml-3>Benjamin Bengfort</span></div></div><div class="sm:ml-10 sm:mt-0 mt-12"><div class="text-lg text-[#1D65A6] font-bold mb-3">Share this post:</div><ul class="grid grid-cols-3 gap-6 mt-4"><li><a onclick=shareByEmail() class="flex items-center"><img src=img/email.png alt class="p-3 bg-white rounded-lg mr-3"></a></li><li><a onclick=shareOnTwitterWithTitle() class="flex items-center"><img src=img/twitter.png alt class="p-3 bg-white rounded-lg mr-4"></a></li><li><a onclick=shareOnLinkedIn() class="flex items-center"><img src=img/linkedin.png alt class="p-3 bg-white rounded-lg mr-3"></a></li></ul></div></div></div><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class="flex justify-between mt-12 sm:mt-24 items-center"><h2 class="font-bold text-2xl sm:text-4xl flex"><span><b class=text-[#1D65A6]>Recent</b>
Rotations</span>
<img src=img/butterfly.png alt=butterfly class="ml-4 h-6 sm:h-8 relative top-1"></h2><div><a href=/blog class="flex text-base sm:text-lg items-center font-bold text-[#1D65A6]"><span>View all</span>
<img src=img/arr-right.png alt class="h-4 ml-2"></a></div></div><div><div class="sm:grid grid-cols-3 gap-8 sm:mt-16"><div class=mt-6><div class=article><a class=block href=https://rotational.io/blog/building-a-raft-part-3/><img src=https://rotational.io/img/blog/2023-02-07-building-a-raft-part-3/otterRaftThree.png alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Distributed Systems</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/building-a-raft-part-3/>Building a Raft (Part 3)</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>In the third and final part of our series exploring the popular consensus algorithm we&rsquo;ll finally explore how Raft handles leader election, and in doing so discover how Raft is so incredibly resilient.</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/team/daniel-sollis.png alt class="rounded-full h-10 w-10">
<span class="ml-4 font-extralight">Daniel Sollis</span></div><div class=font-extralight>Jan 30, 2023</div></div></div></div></div><div class=mt-6><div class=article><a class=block href=https://rotational.io/blog/prototyping-eda-with-watermill/><img src=https://rotational.io/img/blog/watermill.jpg alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Microservices, Eventing</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/prototyping-eda-with-watermill/>Prototyping Event-Driven Applications With Watermill</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>Event-driven architectures (EDA) are <a href=https://rotational.io/blog/five-technologies-quietly-transforming-the-web/>enjoying a resurgence in interest</a> due to many organizations&rsquo; need to accelerate rapid prototyping and get by with smaller, more cross-functional teams. In this post, we&rsquo;ll demonstrate how to …</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/team/prema-roman.png alt class="rounded-full h-10 w-10">
<span class="ml-4 font-extralight">Prema Roman</span></div><div class=font-extralight>Jan 21, 2023</div></div></div></div></div><div class=mt-6><div class=article><a class=block href=https://rotational.io/blog/building-a-raft-part-2/><img src=https://rotational.io/img/blog/2023-01-10-building-a-raft-part-2/otterRaftTwo.png alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Distributed Systems</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/building-a-raft-part-2/>Building a Raft (Part 2)</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>In our first installment on how to implement the famous Raft algorithm, we introduced the log: an ordered sequence of operations that serves as the core data structure for distributed consensus. In this second part, we&rsquo;ll demonstrate …</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/team/daniel-sollis.png alt class="rounded-full h-10 w-10">
<span class="ml-4 font-extralight">Daniel Sollis</span></div><div class=font-extralight>Jan 10, 2023</div></div></div></div></div></div></div></div></div><div class="bg-[#1D65A6] max-w-[800px] mx-auto mt-20 py-14 px-12 md:px-16 text-white md:rounded-lg"><form action=blog method=post id=newsletterForm><h6 class="font-bold text-center">Enter Your Email To Subscribe</h6><label for=email class=hidden>Email</label>
<input type=text name=email id=email required placeholder class="w-full px-4 py-2.5 rounded-lg mt-6 text-black" style=color:#000><div class="flex mt-6 items-start"><input type=checkbox id=checkbox required class="w-6 h-6 block border-0">
<label for=checkbox><span class="ml-2 text-left">I want to receive the monthly newsletter and other updates from Rotational. You agree to our Privacy Policy. You may unsubscribe at any time.*</span></label></div><div class="bg-teal-100 border-t-4 border-teal-500 mt-10 rounded-b text-teal-900 px-4 py-3 shadow-md hidden" id=newsletter-alert role=alert><div class=flex><div><p class=text-sm>Thank you for your interest!</p></div></div></div><div class="flex justify-center"><button type=submit class="bg-[#192E5B] px-14 py-4 mt-10 rounded-lg text-sm text-white uppercase md:text-base">
Submit</button></div></form></div></main><div id=footerBackground><footer class="bg-hero-footer bg-cover"><div class="relative pt-[350px] font-extralight"><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class="lg:grid grid-cols-3 text-white"><div><a href=/><img src=img/logo-white.png alt="Rotational Labs logo" class="mt-10 sm:mt-0 mx-auto sm:pb-5"></a></div><div class="mx-auto mt-5 sm:mt-0 max-w-lg pb-8 xl:mr-5"><h5 class="text-center lg:text-start font-bold text-lg">Contact Details</h5><p class="mt-3 ml-10 sm:ml-0 text-lg">We love to talk through complex scaling and performance issues. What’s slowing you down? Drop us a line for a friendly chat. We’ll make it worth your while.</p></div><div class="ml-10 xl:ml-5 sm:mt-0 mt-8"><ul class="sm:grid grid-cols-2 lg:flex flex-col gap-0 mr-5 xl:grid gap-x-32 gap-y-4"><li class=pb-8><a href=mailto:info@rotational.io class="flex items-center" target=_blank><img src=img/email.png alt class="p-4 bg-white rounded-lg mr-4">
<span>info@rotational.io</span></a></li><li class=pb-8><a href=https://github.com/rotationalio class="flex items-center" target=_blank><img src=img/github.png alt class="p-4 bg-white rounded-lg mr-4">
<span>rotationalio</span></a></li><li class=pb-8><a href=https://twitter.com/rotationalio class="flex items-center" target=_blank><img src=img/twitter.png alt class="p-4 bg-white rounded-lg mr-4">
<span>@rotationalio</span></a></li><li class=pb-8><a href=https://www.linkedin.com/company/rotational class="flex items-center" target=_blank><img src=img/linkedin.png alt class="p-4 bg-white rounded-lg mr-4">
<span>Rotational</span></a></li></ul></div></div><div class="sm:flex justify-between border-t py-6 text-white mt-12 sm:mt-32"><p>Copyright © 2023 Rotational Labs, Inc · All Rights Reserved</p><ul class="sm:mt-0 mt-4 flex"><li class="border-r pr-4 mr-4"><a href=/privacy/>Privacy Policy</a></li><li><a href=/terms/>Terms of Use</a></li></ul></div></div></div></footer></div><script src=https://rotational.io/js/app.js></script></body></html>