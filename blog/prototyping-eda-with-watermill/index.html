<!doctype html><html lang=en-us><head><meta charset=UTF-8><title>Rotational Labs | Prototyping Event-Driven Applications With Watermill</title>
<base href=https://rotational.io/ target=_self><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Rotational Labs, Inc."><meta name=description content="An introduction to using the Watermill API to enable rapid prototyping for event-driven architectures."><meta name=keywords content="ai for companies,ai software,ai consulting,ai solutions,ai development,enterprise ai,ai services,ai platform,ai applications,ai for business,artificial intelligence solutions,artificial intelligence consulting"><link type=text/plain rel=author href=https://rotational.io/humans.txt><meta property="og:title" content="Prototyping Event-Driven Applications With Watermill"><meta property="og:description" content="An introduction to using the Watermill API to enable rapid prototyping for event-driven architectures."><meta property="og:image" content="https://rotational.io/img/blog/watermill.jpg"><meta property="og:url" content="https://rotational.io/blog/prototyping-eda-with-watermill/"><meta property="og:type" content="website"><meta name=twitter:title content="Prototyping Event-Driven Applications With Watermill"><meta name=twitter:card content="summary"><meta name=twitter:description content="An introduction to using the Watermill API to enable rapid prototyping for event-driven architectures."><meta name=twitter:image content="https://rotational.io/img/blog/watermill.jpg"><link rel="shortcut icon" href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=icon href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=alternate type=application/rss+xml href=https://rotational.io//index.xml title="Recent Rotations of the Rotational Labs Blog"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap" rel=stylesheet><link rel=stylesheet href=https://rotational.io/output.css media=screen><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",analytics_storage:"denied",functionality_storage:"denied",personalization_storage:"denied"});const _hsp=window._hsp=window._hsp||[];_hsp.push(["addPrivacyConsentListener",function(e){const s=e&&(e.allowed||e.categories&&e.categories.analytics),t=e&&(e.allowed||e.categories&&e.categories.advertisement),n=e&&(e.allowed||e.categories&&e.categories.functionality);gtag("consent","update",{ad_storage:t?"granted":"denied",ad_user_data:t?"granted":"denied",ad_personalization:t?"granted":"denied",analytics_storage:s?"granted":"denied",functionality_storage:n?"granted":"denied",personalization_storage:n?"granted":"denied"})}])</script><script src="https://www.googletagmanager.com/gtag/js?id=G-2FKX6CWJHW" async defer></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2FKX6CWJHW")</script><script async defer src="https://www.google.com/recaptcha/enterprise.js?render=6Ld5O3kiAAAAAJU0z0h81X1RxEMHyoROe6KWe_vk"></script><script src=https://kit.fontawesome.com/fea17a4e21.js crossorigin=anonymous></script></head><body><div class="relative bg-[#1D65A6]"><nav class="w-full max-w-7xl mx-auto px-4 sm:px-6 py-5" aria-label=Global><div class="relative max-w-7xl w-full flex flex-wrap lg:flex-nowrap items-center justify-between mx-auto"><a href=/><img src=/img/rototational-white-text-only_hu15583614935666962927.webp alt=Rotational class="h-6 w-auto">
</a><button data-collapse-toggle=navbar-dropdown type=button class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls=navbar-dropdown aria-expanded=false>
<span class=sr-only>Open main menu</span>
<i class="fa fa-bars text-xl text-white"></i></button><div class="hidden absolute z-[9999] lg:static top-16 w-[92%] md:w-[96%] lg:w-auto lg:block bg-white lg:bg-transparent text-[#192E5B] lg:text-[#F2F2F2] py-2 rounded-md" id=navbar-dropdown><ul class="flex flex-col lg:gap-2 xl:gap-4 md:flex-row font-semibold w-full md:justify-between"><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><a class="px-3 py-3.5 hover:text-black" href=/about/>About</a></li><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><button id=dropdownNavbarLink data-dropdown-toggle=dropdownNavbar class="uppercase flex items-center justify-between gap-x-2 w-full px-3 rounded md:border-0 md:p-0 md:w-auto hover:text-black">
Services
<i class="fa fa-angle-down pt-1"></i></button><div id=dropdownNavbar class="z-10 hidden font-normal bg-[#192E5B] divide-y divide-[#192E5B] rounded-lg shadow w-44"><ul class="py-2 text-sm text-[#F2F2F2]" aria-labelledby=dropdownLargeButton><li><a href=/services/ai-assessments/ class="block px-3 py-2 hover:font-bold">AI Assessments</a></li><li><a href=/services/ai-product-development/ class="block px-3 py-2 hover:font-bold">AI Product Development</a></li><li><a href=/services/ai-ops-and-data-foundations/ class="block px-3 py-2 hover:font-bold">AI Ops & Data Foundations</a></li></ul></div></li><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><a class="px-3 py-3.5 hover:text-black" href=/case-studies>Case Studies</a></li><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><a class="px-3 py-3.5 hover:text-black" href=/blog/>Blog</a></li><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><a class="px-3 py-3.5 hover:text-black" href=/learning/>Learning</a></li><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><a class="px-3 py-3.5 hover:text-black" href=/endeavor/>Product</a></li><li class="py-2 uppercase text-sm lg:text-[15px] xl:text-[17px]"><a class="px-3 py-3.5 hover:text-black" href=/contact/>Contact</a></li></ul></div></div></nav></div><main><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class=mt-14><div class=blog-img><img src=/img/blog/watermill_hu17407250542933457264.webp alt="Prototyping Event-Driven Applications With Watermill" class="mx-auto object-cover"></div><div class=mt-8><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl text-center" data-blog-title="Prototyping Event-Driven Applications With Watermill"><b class=text-[#1D65A6]>Prototyping </b>Event-Driven Applications With Watermill</h3><div class="flex flex-wrap justify-center items-center my-6"><a href=/authors/prema-roman><img src=img/team/prema-roman.png alt class="mr-3 border-4 border-white rounded-full h-11 drop-shadow-lg">
</a><span><a href=/authors/prema-roman>Prema Roman</a> | Saturday, Jan 21, 2023 |&nbsp;
</span><span><a href=/tags/microservices>Microservices</a>,&nbsp;
</span><a href=/tags/eventing>Eventing</a></span></div><article class="max-w-[800px] mx-auto prose mt-12"><p>Event-driven architectures (EDA) are <a href=https://rotational.io/blog/five-technologies-quietly-transforming-the-web/>enjoying a resurgence in interest</a> due to many organizations&rsquo; need to accelerate rapid prototyping and get by with smaller, more cross-functional teams. In this post, we&rsquo;ll demonstrate how to get started prototyping EDAs with the open source package Watermill.</p><p>Event-driven architecture is a powerful framework for building modern applications. Unlike conventional applications, which follow a request-response pattern, EDA enables the decoupling of software components, allowing them to asynchronously pass data between each other. EDA often helps reduce latency and increase throughput and is well suited for modern, distributed system architectures. It also opens up opportunities for organizations to build more responsive applications and more quickly integrate new features.</p><h2 id=eventing-is-hard-watermill-makes-it-a-little-easier>Eventing is Hard, Watermill Makes it a Little Easier</h2><p>While there are many ways to build event-driven applications (check out <a href=https://rotational.io/blog/eventing-platforms/>this post</a> to learn more about the types of tools available), building event-driven applications is still pretty hard. It requires advanced software engineering skills and DevOps skills to get projects up and running. On top of that, there is a lack of standardization among tools, so it is difficult to make changes to tooling after the fact (e.g. once a team has a better understanding of the throughput/latency needs of their app).</p><p>This is where <a href=https://watermill.io>Watermill</a> comes in. Watermill is an open source Golang package that enables developers unfamiliar with EDA to get started building event-driven applications. Furthermore, it provides a standardized API that allows developers to experiment with different EDA tools. It is very simple to start building applications in one eventing tool, and with just a few changes, switch to another. The goal of Watermill, as the creators have stated, is &ldquo;to make communication with messages as easy to use as HTTP routers.&rdquo; They go on to say:</p><blockquote><p>Just like you don’t need to know the whole TCP stack to create a HTTP REST server, you shouldn’t need to study all of this knowledge to start with building message-driven applications.</p></blockquote><h2 id=the-basics-of-eventing>The Basics of Eventing</h2><p>At the core of EDA is the <strong>event</strong> (or <strong>message</strong>), for example, a customer adding an item to a shopping cart or a smart light being turned on. In the EDA framework, a <strong>producer</strong> (or <strong>publisher</strong>) writes these events to a <strong>topic</strong>, while a <strong>consumer</strong> (or <strong>subscriber</strong>) listens to the topic stream, consuming and processing messages as they arrive.</p><p>There are several advantages to this framework. First, the producer and consumer applications can be built independently of each other and the processing can be asynchronous. There is no need for blocking code execution as there is in a traditional request/response framework, where the client has to block until it gets a response from the server. Second, the producer application can simply send data in its raw form, and it is up to the consumer application to do the data transformations that is suited for its use case. This opens up the possibilities of having multiple consumers listening on the same topic to serve different business functions.</p><h2 id=getting-started-with-watermill>Getting Started with Watermill</h2><p>Watermill provides a very simple interface to create a publisher and a subscriber. The following code snippets assume that <strong>watermill</strong>, <strong>ensign</strong>, and <strong>watermill-ensign</strong> have already been installed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Publisher</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Publish</span>(<span style=color:#a6e22e>topic</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>messages</span> <span style=color:#f92672>...*</span><span style=color:#a6e22e>Message</span>) <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Close</span>() <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Subscriber</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Subscribe</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>topic</span> <span style=color:#66d9ef>string</span>) (<span style=color:#f92672>&lt;-</span><span style=color:#66d9ef>chan</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Message</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Close</span>() <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Creating a new publisher or subscriber is also very straightforward. Here is an example of how you can add a new publisher using an event streaming platform of your choice through the Watermill API.</p><p>Let&rsquo;s say you want to start with Kafka:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>publisher</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kafka</span>.<span style=color:#a6e22e>NewPublisher</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>kafka</span>.<span style=color:#a6e22e>PublisherConfig</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Brokers</span>:   <span style=color:#a6e22e>brokers</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Marshaler</span>: <span style=color:#a6e22e>kafka</span>.<span style=color:#a6e22e>DefaultMarshaler</span>{},
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>logger</span>,
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>publisher</span>.<span style=color:#a6e22e>Close</span>()
</span></span></code></pre></div><p>If you later want to test out another backend, it&rsquo;s just a very minor code change thanks to the power of the Watermill API! Here&rsquo;s the same example as above, but with <a href=https://rotational.io/ensign/><strong>Ensign</strong></a>, a new self-orchestrating eventing platform:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>publisher</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ensign</span>.<span style=color:#a6e22e>NewPublisher</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>ensign</span>.<span style=color:#a6e22e>PublisherConfig</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Marshaler</span>: <span style=color:#a6e22e>marshaler</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>logger</span>,
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>publisher</span>.<span style=color:#a6e22e>Close</span>()
</span></span></code></pre></div><p>Here is how you can add a new subscriber with Kafka:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>sub</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>kafka</span>.<span style=color:#a6e22e>NewSubscriber</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>kafka</span>.<span style=color:#a6e22e>SubscriberConfig</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Brokers</span>:       <span style=color:#a6e22e>brokers</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Unmarshaler</span>:   <span style=color:#a6e22e>marshaler</span>,
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>ConsumerGroup</span>: <span style=color:#a6e22e>consumerGroup</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>logger</span>,
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span></code></pre></div><p>And here&rsquo;s how you&rsquo;d do it with Ensign:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>sub</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ensign</span>.<span style=color:#a6e22e>NewSubscriber</span>(
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>ensign</span>.<span style=color:#a6e22e>SubscriberConfig</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>Unmarshaler</span>: <span style=color:#a6e22e>marshaler</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>logger</span>,
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span></code></pre></div><p>As you can see, it is fairly straightforward to get started! When you&rsquo;re ready to dig in a bit deeper, Watermill offers more advanced functionalities such as retry logic, throttling, poison queue, and observability metrics through the use of a component called <a href=https://watermill.io/docs/messages-router/>router</a>.</p><p>The following flowchart shows how the router can be used:</p><p><img alt=&ldquo;Router&rdquo; src=/img/blog/2023-01-19-test-driving-event-driven-applications-with-watermill/router.png></p><p>For those who have worked with HTTP requests, this probably looks familiar. The idea behind the router is that you can add any number of handlers that determine how to handle new messages that arrive on a topic. If you need to add more functionality to execute before or after the handler functions, Watermill has added middleware options, which are essentially decorator functions on top of the handler function. These middleware functions can be added to a specific handler or directly on the router to apply to every single message that is sent to the router.</p><p>The following is the function signature for a handler:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Router</span>) <span style=color:#a6e22e>AddHandler</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>handlerName</span> <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>subscribeTopic</span> <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>subscriber</span> <span style=color:#a6e22e>Subscriber</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>publishTopic</span> <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>publisher</span> <span style=color:#a6e22e>Publisher</span>,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>handlerFunc</span> <span style=color:#a6e22e>HandlerFunc</span>,
</span></span><span style=display:flex><span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>Handler</span>
</span></span></code></pre></div><p>The <code>handlerName</code> is a unique value assigned to the handler. The handler receives the messages from the <code>subscribeTopic</code> and the handlerFunc is the function that gets executed by the subscriber when a new message arrives on the <code>subscribeTopic</code>. The handlerFunc returns new messages and puts them on the <code>publishTopic</code>. At this point, the publisher code gets executed. If there is no need for a publisher, then there is also an option to use a <code>NoPublisherHandler</code> where the handler only executes the subscriber function when a new message arrives in the <code>subscribeTopic</code>.</p><p>The function signature for a middleware is as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>HandlerMiddleware</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>h</span> <span style=color:#a6e22e>HandlerFunc</span>) <span style=color:#a6e22e>HandlerFunc</span>
</span></span></code></pre></div><p>Watermill already comes with several middleware options which are available <a href=https://github.com/ThreeDotsLabs/watermill/tree/master/message/router/middleware>here</a> but you can also build your own custom middleware and add it to the router. The following is an example where multiple middlewares are added to the router:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// Router level middleware are executed for every message sent to the router
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>   <span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>AddMiddleware</span>(
</span></span><span style=display:flex><span>        <span style=color:#75715e>// CorrelationID will copy the correlation id from the incoming message&#39;s metadata to the produced messages
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#a6e22e>middleware</span>.<span style=color:#a6e22e>CorrelationID</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// The handler function is retried if it returns an error.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#75715e>// After MaxRetries, the message is N&#39;acked and it&#39;s up to the PubSub to resend it.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#a6e22e>middleware</span>.<span style=color:#a6e22e>Retry</span>{
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>MaxRetries</span>:      <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>InitialInterval</span>: <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Millisecond</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Logger</span>:          <span style=color:#a6e22e>logger</span>,
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>Middleware</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Recoverer handles panics from handlers.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#75715e>// In this case, it passes them as errors to the Retry middleware.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>       <span style=color:#a6e22e>middleware</span>.<span style=color:#a6e22e>Recoverer</span>,
</span></span><span style=display:flex><span>    )
</span></span></code></pre></div><h2 id=all-pros-and-no-cons>All Pros and No Cons?</h2><p>With all of these building blocks, a <a href=https://watermill.io/docs/getting-started/>Getting Started</a> guide, and several <a href=https://github.com/ThreeDotsLabs/watermill/tree/master/_examples>examples</a> in the Watermill repo to try out, it is very easy to get started building event-driven applications. So what&rsquo;s the downside?</p><p>Watermill is not an eventing system itself, but rather provides a common API that can be used to interface with many differing underlying eventing backends (e.g. RabbitMQ, Kafka, Google PubSub, etc). As such, it does have limited functionality compared to the SDKs exposed directly by these backend eventing tools. But this is not a big setback, given that the purpose of Watermill is to enable teams to experiment and prototype architectures without having to go through the pains of setting up clusters and scaling up node resources. It&rsquo;s nice to be able to focus on data flows, transformations, and application logic rather than editing tons of YAML files before you can even get started!</p><p>Want early access to a platform and community for developers building event-driven apps? Check out our <a href=https://rotational.app/register/>free beta of Ensign</a>.</p><h2 id=stay-tuned>Stay Tuned!</h2><p>In the next blog post, I will cover an end-to-end use case using Watermill and <a href=https://rotational.io/ensign/><strong>Ensign</strong></a>, which like Watermill abstracts away much of the complexities of eventing so that you can focus on building more apps!</p><div class="border-t my-12"></div><p>Photo by Terence Mangram on Flickr Commons</p></article></div></div><div class="bg-[#E8EFF6] max-w-[800px] mx-auto mt-9 p-8 rounded-lg"><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl text-center mb-3"><span class="text-[#1D65A6] font-bold">About </span>This Post</h3><p class="text-base mx-auto px-2 text-center lg:text-base">An introduction to using the Watermill API to enable rapid prototyping for event-driven architectures.</p><div class="flex flex-col md:flex-row text-center mx-auto border-t pt-6 mt-6 align-center justify-between gap-10"><div class=lg:w-1/2><h2 class="text-lg text-[#1D65A6] font-bold mb-3">Written by:</h2><div class="flex items-center"><a href=/authors/prema-roman><img src=img/team/prema-roman.png alt class="mr-3 border-4 border-white rounded-full h-11 drop-shadow-lg">
</a><span class="flex flex-wrap"><a href=/authors/prema-roman class="lg:w-[20ch] mx-2">Prema Roman</a></span></div></div><div class=lg:w-1/2><h2 class="text-lg text-[#1D65A6] font-bold mb-3">Share this post:</h2><ul class="flex items-center justify-center gap-6 mt-4"><li><a onclick=shareByEmail() class=cursor-pointer><img src=img/email.png alt class="rounded-lg bg-white p-3"></a></li><li><a onclick=shareOnTwitterWithTitle() class=cursor-pointer><img src=img/twitter.png alt class="rounded-lg bg-white p-3"></a></li><li><a onclick=shareOnLinkedIn() class=cursor-pointer><img src=img/linkedin.png alt class="rounded-lg bg-white p-3"></a></li></ul></div></div></div><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class="flex justify-between mt-12 sm:mt-24 items-center"><div class="flex items-center"><h2 class="font-bold text-2xl sm:text-4xl flex"><span class=text-[#1D65A6]>Recommended</span>
&nbsp;Rotations</h2></div><div><a href=/blog class="flex text-base sm:text-lg items-center font-bold text-[#1D65A6]"><span>View all</span>
<img src=img/arr-right.png alt class="h-4 ml-2"></a></div></div><div><ul class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:my-8"><li class="mt-6 bg-[#ECF6FF] rounded-xl"><div class="flex flex-col h-full"><a href=https://rotational.io/blog/welcome-to-ensign-u/><img loading=lazy src=/img/blog/library_hu6982029488749424350.webp alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="px-4 pt-4"><ul class="flex flex-wrap"><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/python>Python</a>,&nbsp;</li><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/eventing>Eventing</a>,&nbsp;</li><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/ml>ML</a></li></ul><div class="flex flex-col mt-4 h-full"><h3 class="text-xl font-extrabold sm:h-36"><a href=https://rotational.io/blog/welcome-to-ensign-u/ class=block>Welcome to Ensign U!</a></h3><div class=mb-4><p class="my-4 sm:mt-auto">Like any new tool, Ensign takes a little time to learn. But take it from us (a bunch of seasoned data science experts) &ndash; it will open up a new world of data science applications for you. Check out this beginner-friendly introduction!</p></div></div></div><div class="flex justify-between mt-auto items-center border-t px-4 py-3 h-16"><div class="flex items-center"><img loading=lazy src=/img/butterfly_hu14572934016300068338.png alt class="rounded-full h-10 w-10"><ul class="flex flex-wrap ml-4"><li class=font-extralight><a href=/authors/rotational-labs>Rotational Labs</a></li></ul></div><div class=font-extralight>Oct 20, 2023</div></div></div></li><li class="mt-6 bg-[#ECF6FF] rounded-xl"><div class="flex flex-col h-full"><a href=https://rotational.io/blog/realtime-machine-learning/><img loading=lazy src=/img/blog/2023-08-07-realtime-machine-learning/bird-fly-unsplash_hu7209337365396706980.webp alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="px-4 pt-4"><ul class="flex flex-wrap"><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/nlp>NLP</a>,&nbsp;</li><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/ai>AI</a>,&nbsp;</li><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/ml>ML</a>,&nbsp;</li><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/eventing>Eventing</a></li></ul><div class="flex flex-col mt-4 h-full"><h3 class="text-xl font-extrabold sm:h-36"><a href=https://rotational.io/blog/realtime-machine-learning/ class=block>Using River and Vowpal Wabbit to Build Real-Time Machine Learning Models</a></h3><div class=mb-4><p class="my-4 sm:mt-auto">Real-time ML models continually learn on new data as soon as it arrives, so they&rsquo;re less susceptible to concept drift and data drift. Read on to learn how to use River and Vowpal Wabbit to build real-time models in Python.</p></div></div></div><div class="flex justify-between mt-auto items-center border-t px-4 py-3 h-16"><div class="flex items-center"><img loading=lazy src=/img/team/prema-roman_hu8516555698015783157.png alt class="rounded-full h-10 w-10"><ul class="flex flex-wrap ml-4"><li class=font-extralight><a href=/authors/prema-roman>Prema Roman</a></li></ul></div><div class=font-extralight>Aug 11, 2023</div></div></div></li><li class="mt-6 bg-[#ECF6FF] rounded-xl"><div class="flex flex-col h-full"><a href=https://rotational.io/blog/eventing-platforms/><img loading=lazy src=/img/blog/herd_hu5971893232816109227.webp alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="px-4 pt-4"><ul class="flex flex-wrap"><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/microservices>Microservices</a>,&nbsp;</li><li class="text-base font-bold text-[#1D65A6]"><a href=/tags/eventing>Eventing</a></li></ul><div class="flex flex-col mt-4 h-full"><h3 class="text-xl font-extrabold sm:h-36"><a href=https://rotational.io/blog/eventing-platforms/ class=block>The Eventing Platform Landscape</a></h3><div class=mb-4><p class="my-4 sm:mt-auto">Kafka and PubSub and Kinesis, oh my! Which eventing platform is best? In this post we&rsquo;ll explore the three primary categories of eventing systems and understand their similarities, differences, and key use cases.</p></div></div></div><div class="flex justify-between mt-auto items-center border-t px-4 py-3 h-16"><div class="flex items-center"><img loading=lazy src=/img/team/rebecca-bilbro_hu805534418946307216.png alt class="rounded-full h-10 w-10"><ul class="flex flex-wrap ml-4"><li class=font-extralight><a href=/authors/rebecca-bilbro>Rebecca Bilbro</a></li></ul></div><div class=font-extralight>Sep 10, 2022</div></div></div></li></ul></div></div></div><div class="bg-[#1D65A6] max-w-[800px] mx-auto mt-20 py-8 px-12 md:px-16 text-white md:rounded-lg"><input type=hidden id=newsletterFormID value=8aeeb77b-a5e0-4772-b726-44e1fc2eb6e1><form action=blog method=post id=newsletterForm><h6 class="font-bold text-center">Enter Your Email To Subscribe</h6><div class="bg-teal-100 border-t-4 border-teal-500 mt-3 rounded-b text-teal-900 p-4 shadow-md hidden" id=newsletter-alert role=alert><div class=flex><div><p class=text-sm>Thank you for joining the Rotational Labs newsletter!</p></div></div></div><div id=newsletter-error class="hidden mt-3 bg-red-200 border-t-4 border-red-600 text-red-900 rounded-b p-4 shadow-md" role=alert><div><p class=text-sm>Your request did not go through, please try again. If you need immediate assistance, please email support@rotational.io.</p></div></div><label for=email class=hidden>Email</label>
<input type=text name=email id=email required placeholder class="w-full px-4 py-2.5 rounded-lg mt-6 text-black" style=color:#000><div class="flex mt-6 items-start gap-x-2"><input type=checkbox id=checkbox required name=consent class="mt-1 w-4 h-4 block border-0">
<label for=checkbox><span id=consentText>I want to receive the monthly newsletter and other updates from Rotational. You agree to our Privacy Policy. You may unsubscribe at any time.*</span></label></div><div class="flex justify-center"><button type=submit class="bg-[#192E5B] px-10 py-3 mt-8 rounded-lg text-sm text-white uppercase md:text-base hover:bg-[#192E5B]/80">
Submit</button></div></form></div></main><footer class="relative mt-40 md:mt-56 bg-[#192E5B]"><div class="relative w-full pt-36 md:pt-16 lg:pt-24 2xl:pt-20 font-extralight text-white"><div class="-mt-52 w-full mx-auto max-w-screen-xl px-4"><section class="bg-[#72A2C0] w-full p-6 md:py-20 md:px-16"><h2 class="my-4 text-2xl sm:text-3xl md:text-5xl text-white font-extrabold">LET'S ENVISION & BUILD THE FUTURE TOGETHER.</h2><div class=py-6><a href=/contact class="p-3 md:p-4 md:px-6 bg-[#2F4858] font-bold md:text-lg text-white text-center hover:bg-[#2F4858]/80">CONTACT US</a></div></section></div><div class="max-w-7xl mx-auto px-6"><div class="mt-12 flex flex-col md:flex-row lg:justify-between gap-x-8"><div class="my-4 max-w-xs"><h5 class="mb-3 font-extrabold">OUR PRESENCE</h5><p>We share because we care, about topics, tools, and technologies that we believe impact the AI economy.</p><div class=py-4><ul class="flex justify-between items-center gap-x-8"><li><a href=https://twitter.com/rotationalio target=_blank class=hover:text-[#1D65A6]><i class="text-2xl fa-brands fa-x-twitter"></i><p class=sr-only>Twitter</p></a></li><li><a href=https://www.linkedin.com/company/rotational target=_blank class=hover:text-[#1D65A6]><i class="text-2xl fa-brands fa-linkedin"></i><p class=sr-only>LinkedIn</p></a></li><li><a href=https://github.com/rotationalio target=_blank class=hover:text-[#1D65A6]><i class="text-2xl fa-brands fa-github"></i><p class=sr-only>GitHub</p></a></li><li><a href=https://www.youtube.com/@rotationalio target=_blank class=hover:text-[#1D65A6]><i class="text-2xl fa-brands fa-youtube"></i><p class=sr-only>YouTube</p></a></li><li><a href=https://www.twitch.tv/rotationallabs target=_blank class=hover:text-[#1D65A6]><i class="text-2xl fa-brands fa-twitch"></i><p class=sr-only>Twitch</p></a></li></ul></div></div><div class=my-4><h5 class="mb-3 font-extrabold">COMPANY</h5><ul><li class="pb-3 flex items-center gap-x-2"><i class="fa-solid fa-chevron-right text-[#757575] text-xs"></i>
<a href=/about>About Us</a></li><li class="pb-3 flex items-center gap-x-2"><i class="fa-solid fa-chevron-right text-[#757575] text-xs"></i>
<a href=/case-studies>Case Studies</a></li><li class="pb-3 flex items-center gap-x-2"><i class="fa-solid fa-chevron-right text-[#757575] text-xs"></i>
<a href=/endeavor>Endeavor</a></li><li class="pb-3 flex items-center gap-x-2"><i class="fa-solid fa-chevron-right text-[#757575] text-xs"></i>
<a href=/blog>Blog</a></li></ul></div><div class=my-4><h5 class="mb-3 font-extrabold">COMMUNITY</h5><ul><li class="pb-3 flex items-center gap-x-2"><i class="fa-solid fa-chevron-right text-[#757575] text-xs"></i>
<a href=/learning>Learning</a></li><li class="pb-3 flex items-center gap-x-2"><i class="fa-solid fa-chevron-right text-[#757575] text-xs"></i>
<a href=/opensource>Open Source</a></li></ul></div><div class=my-4><h5 class="mb-3 font-extrabold">CONTACT US</h5><ul><li class="flex items-baseline lg:items-center gap-x-2"><i class="fa-solid fa-map-marker-alt text-[#757575]"></i>
St. Paul, MN & Washington, DC</li><li class="flex items-baseline lg:items-center gap-x-2"><i class="fa-solid fa-envelope text-[#757575]"></i>
info@rotational.io</li></ul><div class=py-8><a href=/contact class="p-3 bg-[#ECF6FF] font-bold text-black text-center hover:bg-[#ECF6FF]/80">CONTACT US</a></div></div></div><div class="sm:flex justify-between py-6 border-t mt-4"><p>Copyright © Rotational Labs, Inc. 2021–2025 · All Rights Reserved</p><div><ul class="sm:mt-0 mt-4 flex gap-x-8"><li><a href=/privacy/>Privacy Policy</a></li><li><a href=/terms/>Terms of Use</a></li></ul></div></div></div></div></footer><script src=https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js></script><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/24168101.js></script><script src=https://rotational.io/js/blogSingle.js></script><script src=https://rotational.io/js/newsletterForm.js></script></body></html>