<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Rotational Labs | Mocking the Universe: Two Techniques for Testing gRPC with Mocks</title><base href=https://rotational.io/ target=_self><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Daniel Sollis"><meta name=description content="Mocking can be an easy way to get around gRPC connections when testing."><meta name=keywords content="Rotational Labs,Ensign,Cloud-native,Real-time data streaming platform,Data collaboration,Data automation,Rapid prototyping,Real-time machine learning,Real-time data analytics,Real-time applications,Data streams,Event streams,Event-sourcing databaseEvent log"><link type=text/plain rel=author href=https://rotational.io/humans.txt><meta property="og:title" content="Mocking the Universe: Two Techniques for Testing gRPC with Mocks"><meta property="og:description" content="Mocking can be an easy way to get around gRPC connections when testing."><meta property="og:image" content="https://rotational.io/img/blog/2023-03-08-mocking-the-universe/monkey-in-mirror.jpg"><meta property="og:url" content="https://rotational.io/blog/mocking-the-universe/"><meta property="og:type" content="website"><meta name=twitter:title content="Mocking the Universe: Two Techniques for Testing gRPC with Mocks"><meta name=twitter:card content="summary"><meta name=twitter:description content="Mocking can be an easy way to get around gRPC connections when testing."><meta name=twitter:image content="https://rotational.io/img/blog/2023-03-08-mocking-the-universe/monkey-in-mirror.jpg"><link rel="shortcut icon" href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=icon href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=alternate type=application/rss+xml href=https://rotational.io//index.xml title="Recent Rotations of the Rotational Labs Blog"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.css><link rel=stylesheet href=https://unpkg.com/@highlightjs/cdn-assets/styles/default.min.css><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap" rel=stylesheet><link rel=stylesheet href=https://rotational.io/output.css media=screen><script async src="https://www.googletagmanager.com/gtag/js?id=G-2FKX6CWJHW"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2FKX6CWJHW")</script><script src="https://www.google.com/recaptcha/enterprise.js?render=6Ld5O3kiAAAAAJU0z0h81X1RxEMHyoROe6KWe_vk"></script>
<script>grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute("6Ld5O3kiAAAAAJU0z0h81X1RxEMHyoROe6KWe_vk",{action:"homepage"}).then(function(){})})</script><script src=https://kit.fontawesome.com/2c36e9b7b1.js crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr/lunr.js></script></head><body class="bg-hexagon bg-center bg-contain"><div class="relative bg-[#1D65A6]"><nav class="relative max-w-7xl mx-auto flex items-center justify-between text-white px-4 sm:px-6 z-[9999] py-5" aria-label=Global><a href=/><img src=img/logo.png alt="Rotational Lab logo" class="h-14 w-auto sm:h-14"></a><div class=topnav id=myTopnav><a href=/ensign/>Ensign</a>
<a href=/data-playground>Data Playground</a>
<a href=/opensource/>Open Source</a>
<a href=/blog/>Blog</a>
<a href=/about/>About</a>
<a href=https://rotational.app>Login</a>
<a class=icon onclick=openMobNav()><i class="fa fa-bars"></i></a></div></nav></div><main><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class=mt-14><div class=blog-img><img src=https://rotational.io/img/blog/2023-03-08-mocking-the-universe/monkey-in-mirror.jpg alt="Mocking the Universe: Two Techniques for Testing gRPC with Mocks" class="mx-auto object-cover"></div><div class=mt-8><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl text-center" data-blog-title="Mocking the Universe: Two Techniques for Testing gRPC with Mocks"><b class=text-[#1D65A6]>Mocking</b>
the Universe: Two Techniques for Testing gRPC with Mocks</h3><div class="flex justify-center items-center mt-4 mb-6"><img src=img/team/daniel-sollis.png alt class="border-4 border-white rounded-full h-11 drop-shadow-lg"><span class=ml-3>Daniel Sollis |
Tuesday, Mar 28, 2023 | Golang, Programming, Testing, gRPC</span></div><article class="max-w-[800px] mx-auto prose"><p>At Rotational, <a href=https://rotational.io/blog/what-are-protocol-buffers/>we use gRPC</a> <a href=https://rotational.io/blog/documenting-grpc-with-openapi>quite a bit</a>. It&rsquo;s great for specifying network APIs, but can challenge us to find new ways to thoroughly test the code. Follow along with this post to learn two ways of using <a href=https://rotational.io/blog/fake-it-when-you-make-it/>mocking</a> to test gRPC services!</p><h2 id=why-mock>Why Mock?</h2><p>The main reason for using mocks is that they allow you to get around dependencies.</p><p>If you are testing a discrete piece of code, you want to test THAT piece of code, not every dependency it&rsquo;s using as well (hopefully you have separate tests that cover those dependencies ðŸ˜‰).</p><p>The same goes for code using gRPC. When a piece of code calls an RPC, you don&rsquo;t want to have to test the entire <strong>gRPC service</strong> as well as the network (which can be unreliable and <em>super</em> hard to test). But how can we avoid stepping into the implementation details when testing gRPC?</p><p>The easiest way to get around this is to avoid gRPC altogether, with what we at Rotational refer to as <strong>&ldquo;package mocks&rdquo;</strong>. The second technique, which we call <strong>&ldquo;universal mocks&rdquo;</strong>, allows us to directly test gRPC methods in a more structured way. Read on to learn more about both and see some examples.</p><h2 id=package-mocks>Package Mocks</h2><p>In many cases, different gRPC service calls can be isolated into their own packages that contain structs (likely a <strong>gRPC client</strong> or a struct containing the client) that implement the service&rsquo;s procedure calls. By mocking these structs, <strong>&ldquo;package mocks&rdquo;</strong> enable you to avoid not only the <strong>gRPC calls</strong>, but any other dependencies that might show up in the service&rsquo;s implementation.</p><p>Lets imagine we have the following service defined:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-proto data-lang=proto><span style=display:flex><span>syntax <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;proto3&#34;</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>service</span> Database {<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    <span style=color:#66d9ef>rpc</span> Get(GetRequest) <span style=color:#66d9ef>returns</span> (GetReply) {};<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    <span style=color:#66d9ef>rpc</span> Put(PutRequest) <span style=color:#66d9ef>returns</span> (PutReply) {};<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>}<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>In our <code>database</code> package (let&rsquo;s imagine it&rsquo;s inside a file called <code>database/database.go</code>) we might have the following struct defined:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Database</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conf</span> <span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>client</span> <span style=color:#a6e22e>DatabaseNetworkClient</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This struct will take care of all of the service&rsquo;s RPC implementation and will also take care of any state (such as configuration or caching) that the service requires. If we add a new interface called <code>Store</code>, which the <code>Database</code> struct implements:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Store</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>GetRequest</span>) <span style=color:#a6e22e>GetReply</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Put</span>(<span style=color:#a6e22e>PutRequest</span>) <span style=color:#a6e22e>PutReply</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can now start defining a &ldquo;package mock&rdquo; that will allow us to circumvent calls to the <code>Database</code> service by creating a new struct that also implements <code>Store</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>const</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>MockDBGet</span> = <span style=color:#e6db74>&#34;MockDB specified error on call to Get&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>MockDBPut</span> = <span style=color:#e6db74>&#34;MockDB specified error on call to Put&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>MockDB</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Calls</span>      <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ErrorOn</span>    <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewMockDB</span>(<span style=color:#a6e22e>conf</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>MockDB</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>MockDB</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Calls</span>: make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>),
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>d</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>MockDB</span>) <span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>GetRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>GetReply</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>Calls</span>[<span style=color:#a6e22e>MockDBGet</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>ErrorOn</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>MockPeersGet</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>ErrorOn</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>GetReply</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Success</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    }, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>d</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>MockDB</span>) <span style=color:#a6e22e>Put</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>PutRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>PutReply</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>Calls</span>[<span style=color:#a6e22e>MockDBPut</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>ErrorOn</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>MockPeersGet</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>ErrorOn</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>PutReply</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Success</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    }, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The fields we&rsquo;ve added to the mock struct are particularly useful. By using the <code>Calls</code> map, you can verify that the number of calls you expect have actually happened. With the <code>ErrorOn</code> field, you can trigger any RPC call to fail when needed for testing purposes.</p><h2 id=universal-mocks>Universal Mocks</h2><p>Package mocks work perfectly for testing code that uses the package that we are mocking, but what about testing the package and it&rsquo;s RPC calls directly? This going to require a different technique, which we at Rotational refer to as <strong>&ldquo;universal mocks&rdquo;</strong>.</p><p>When testing a package that implements a <strong>gRPC service</strong> we seemingly won&rsquo;t be able to get around having to deal with RPC calls, which bring with them all of the complications of dealing with an unreliable network and whatever dependencies are part of the RPC handling code on the other side of the network.</p><p>Fortunately for us gRPC comes with a built in solution, the <a href=https://pkg.go.dev/google.golang.org/grpc/test/bufconn>Bufconn package</a>. Bufconn provides a way to get around the network dependency by creating an in-memory buffer that simulates a real <strong>gRPC connection</strong>.</p><p>What about the service at the other end of the connection though? Doesn&rsquo;t that still have dependencies that we don&rsquo;t want to deal with? Well, we can mock it with a <strong>&ldquo;universal mock&rdquo;</strong>.</p><p>Let&rsquo;s go back to our original <strong>Database</strong> definition:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Store</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>GetRequest</span>) <span style=color:#a6e22e>GetReply</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Put</span>(<span style=color:#a6e22e>PutRequest</span>) <span style=color:#a6e22e>PutReply</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Database</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conf</span> <span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>client</span> <span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>DatabaseNetworkClient</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In order to test this struct we&rsquo;ll need to create a mocked server with bufconn that this struct&rsquo;s client can connect to, this will be the &ldquo;universal mock&rdquo;, and will look something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>RemoteDB</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>conn</span>        <span style=color:#f92672>*</span><span style=color:#a6e22e>bufconn</span>.<span style=color:#a6e22e>Listener</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>srv</span>         <span style=color:#f92672>*</span><span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>Server</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Calls</span>       <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>OnGet</span>       <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>GetRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>GetReply</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>OnPut</span>       <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>PutRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>PutRequest</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This looks a lot like the Package mock with a few modifications. We keep the <code>Calls</code> map to count specific RPC calls but add a bufconn and <code>grpc.Server</code> to serve with. The <code>OnGet</code> and <code>OnPut</code> field&rsquo;s type is a bit odd and we&rsquo;ll go over those later. Creating a new <code>RemoteDB</code> will be a bit different than with the package mock:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewRemoteDB</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>database</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>RemoteDB</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>conn</span>:  <span style=color:#a6e22e>bufconn</span>.<span style=color:#a6e22e>Listen</span>(<span style=color:#a6e22e>bufsize</span>),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>srv</span>:   <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>NewServer</span>(),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Calls</span>: make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>),
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>pb</span>.<span style=color:#a6e22e>RegisterDatabaseNetworkServer</span>(<span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>srv</span>, <span style=color:#a6e22e>database</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>Serve</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>database</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>Serve</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>srv</span>.<span style=color:#a6e22e>Serve</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>conn</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>())
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>ClientOptions</span>() (<span style=color:#a6e22e>opts</span> []<span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>DialOption</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Create the dialer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>dialer</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>net</span>.<span style=color:#a6e22e>Conn</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>Dial</span>()
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>opts</span> = append(<span style=color:#a6e22e>opts</span>, <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>WithContextDialer</span>(<span style=color:#a6e22e>dialer</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Disable transport security
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>opts</span> = append(<span style=color:#a6e22e>opts</span>, <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>WithInsecure</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>opts</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In the <code>NewRemoteDB</code> function we have to instantiate a new <code>bufconn</code> and gRPC server that we need to register and serve. We also have an additional function for serving with the gRPC server and a method for returning the preferred <code>gRPC.DialOptions</code> to make connecting to the mocked server easier.</p><p>The final piece of the puzzle is the RPC implementations; this is where those odd field types from before come in:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>in</span> <span style=color:#a6e22e>GetRequest</span>) (<span style=color:#a6e22e>out</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>GetReply</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>Calls</span>[<span style=color:#a6e22e>GetRPC</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>OnGet</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>in</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>Put</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>in</span> <span style=color:#a6e22e>PutRequest</span>) (<span style=color:#a6e22e>out</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>PutRequest</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>Calls</span>[<span style=color:#a6e22e>PutRPC</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>OnPut</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>in</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The use of the <code>Calls</code> field is largely the same as with the package mock, but we are basically just calling the functions stored on the <code>OnGet</code> and <code>OnPut</code> fields. Because these reference stored functions (which can do arbitrary behavior), this allows us to specify whatever functionality we want the server to have for these RPCs!</p><p>For example if we want the server to simply return an empty reply:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#a6e22e>mock</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>NewRemoteDB</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>mock</span>.<span style=color:#a6e22e>OnGet</span> = <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>GetRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>GetReply</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>GetReply</span>{}, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#a6e22e>reply</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>mock</span>.<span style=color:#a6e22e>Get</span>()
</span></span></code></pre></div><p>Putting all of this together we get the following universal mock:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>const</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>GetRPC</span>  = <span style=color:#e6db74>&#34;Database/Get&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>PutRPC</span>  = <span style=color:#e6db74>&#34;Database/Put&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>bufsize</span> = <span style=color:#ae81ff>1024</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1024</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>RemoteDB</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>conn</span>        <span style=color:#f92672>*</span><span style=color:#a6e22e>bufconn</span>.<span style=color:#a6e22e>Listener</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>srv</span>         <span style=color:#f92672>*</span><span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>Server</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Calls</span>       <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>OnGet</span>       <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>GetRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>GetReply</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>OnPut</span>       <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>PutRequest</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>PutRequest</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewRemoteDB</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>database</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>RemoteDB</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>conn</span>:  <span style=color:#a6e22e>bufconn</span>.<span style=color:#a6e22e>Listen</span>(<span style=color:#a6e22e>bufsize</span>),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>srv</span>:   <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>NewServer</span>(),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Calls</span>: make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>),
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>pb</span>.<span style=color:#a6e22e>RegisterDatabaseNetworkServer</span>(<span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>srv</span>, <span style=color:#a6e22e>database</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>go</span> <span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>Serve</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>database</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>Serve</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>srv</span>.<span style=color:#a6e22e>Serve</span>(<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>conn</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>())
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>ClientOptions</span>() (<span style=color:#a6e22e>opts</span> []<span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>DialOption</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Create the dialer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>dialer</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>net</span>.<span style=color:#a6e22e>Conn</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>Dial</span>()
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>opts</span> = append(<span style=color:#a6e22e>opts</span>, <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>WithContextDialer</span>(<span style=color:#a6e22e>dialer</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Disable transport security
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>opts</span> = append(<span style=color:#a6e22e>opts</span>, <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>WithInsecure</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>opts</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>in</span> <span style=color:#a6e22e>GetRequest</span>) (<span style=color:#a6e22e>out</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>GetReply</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>Calls</span>[<span style=color:#a6e22e>GetRPC</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>OnGet</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>in</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>RemoteDB</span>) <span style=color:#a6e22e>Put</span>(<span style=color:#a6e22e>ctx</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Context</span>, <span style=color:#a6e22e>in</span> <span style=color:#a6e22e>PutRequest</span>) (<span style=color:#a6e22e>out</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>PutRequest</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>Calls</span>[<span style=color:#a6e22e>PutRPC</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>OnPut</span>(<span style=color:#a6e22e>ctx</span>, <span style=color:#a6e22e>in</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=connecting-the-universal-mock>Connecting the Universal Mock</h3><p>The last step is to have the <code>Database</code> struct&rsquo;s client to the universal mock. We need to add a method to the struct that handles connecting to an RPC server:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>d</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Database</span>) <span style=color:#a6e22e>Connect</span>(<span style=color:#a6e22e>opts</span> <span style=color:#f92672>...</span><span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>DialOption</span>) (<span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>client</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>cc</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>ClientConn</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>cc</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>grpc</span>.<span style=color:#a6e22e>Dial</span>(<span style=color:#e6db74>&#34;bufnet&#34;</span>, <span style=color:#a6e22e>opts</span><span style=color:#f92672>...</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;could not dial database service: %s&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>d</span>.<span style=color:#a6e22e>client</span> = <span style=color:#a6e22e>NewDatabaseNetworkClient</span>(<span style=color:#a6e22e>cc</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>With this method in place, creating and connecting to a universal mock becomes easy as can be:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#a6e22e>mock</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>NewRemoteDB</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>database</span>.<span style=color:#a6e22e>Connect</span>(<span style=color:#a6e22e>mock</span>.<span style=color:#a6e22e>ClientOptions</span>()<span style=color:#f92672>...</span>)
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>At Rotational we frequently use both &ldquo;package mocks&rdquo; and &ldquo;universal mocks&rdquo;. The first allows us to test behavior that would normally engage external gRPC calls without actually having to make external calls. With the second type, we can also get around any gRPC calls by simulating gRPC connection and the expected or resultant behavior.</p><p>Together these techniques have enabled us to more easily test our gRPC services, including those for <a href=https://ensign.rotational.dev/getting-started/>Ensign</a>, our managed eventing platform that takes a lot of the stress out of building microservices. If you&rsquo;re interested in reading more on how we use mocks, check out <a href=https://rotational.io/blog/fake-it-when-you-make-it/>this post next</a>.</p><p>Happy mocking!</p><p><em>Want early access to a platform and community for developers building event-driven apps? Check out our <a href=https://rotational.app/register/>free beta of Ensign</a>.</em></p></article></div></div><div class="bg-[#E8EFF6] max-w-[800px] mx-auto mt-9 p-8 rounded-lg"><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl text-center mb-3"><span class="text-[#1D65A6] font-bold">About</span>
This Post</h3><p class="text-base mx-auto px-2 text-center lg:text-base">Mocking can be an easy way to get around gRPC connections when testing.</p><div class="flex flex-col md:flex-row text-center mx-auto border-t pt-6 mt-6 align-center justify-between gap-10"><div class="lg:w-1/2 text-center"><h2 class="text-lg text-[#1D65A6] font-bold mb-3">Written by:</h2><div class="flex items-center justify-center"><img src=img/team/daniel-sollis.png alt class="border-4 border-white rounded-full drop-shadow-lg w-14 h-14">
<span class="lg:w-[20ch] mx-2">Daniel Sollis</span></div></div><div class=lg:w-1/2><h2 class="text-lg text-[#1D65A6] font-bold mb-3">Share this post:</h2><ul class="flex items-center justify-center gap-6 mt-4"><li><a onclick=shareByEmail() class=cursor-pointer><img src=img/email.png alt class="rounded-lg bg-white p-3"></a></li><li><a onclick=shareOnTwitterWithTitle() class=cursor-pointer><img src=img/twitter.png alt class="rounded-lg bg-white p-3"></a></li><li><a onclick=shareOnLinkedIn() class=cursor-pointer><img src=img/linkedin.png alt class="rounded-lg bg-white p-3"></a></li></ul></div></div></div><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class="flex justify-between mt-12 sm:mt-24 items-center"><h2 class="font-bold text-2xl sm:text-4xl flex"><span><b class=text-[#1D65A6]>Recent</b>
Rotations</span>
<img src=img/butterfly.png alt=butterfly class="ml-4 h-6 sm:h-8 relative top-1"></h2><div><a href=/blog class="flex text-base sm:text-lg items-center font-bold text-[#1D65A6]"><span>View all</span>
<img src=img/arr-right.png alt class="h-4 ml-2"></a></div></div><div><div class="sm:grid grid-cols-3 gap-8 sm:mt-16"><div class=mt-6><div class=article><a class=block href=https://rotational.io/blog/startup-strategies/><img src=https://rotational.io/img/blog/balloons.jpg alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Startups</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/startup-strategies/>Three Strategies for Tech Startups with Heart</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>Working at a startup is an exciting challenge, an opportunity for growth, and not for the faint of heart. Here are a few things that currently resonate with our team, immersed as we are in that startup life.</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/team/beci-lambrecht.png alt class="rounded-full h-10 w-10">
<span class="ml-4 font-extralight">Beci Lambrecht</span></div><div class=font-extralight>Jun 8, 2023</div></div></div></div></div><div class=mt-6><div class=article><a class=block href=https://rotational.io/blog/async-or-swim/><img src=https://rotational.io/img/blog/mississippi.jpg alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Eventing, Golang</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/async-or-swim/>Async or Swim: A Developer's Guide to Wading into Asynchronous Processing</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>The Go programming language provides powerful tools for managing concurrency, but robust asynchronous code requires us as developers to design around uncertain tasks and manifold queues. Step through an async codebase with us in this post!</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/team/patrick-deziel.png alt class="rounded-full h-10 w-10">
<span class="ml-4 font-extralight">Patrick Deziel</span></div><div class=font-extralight>Jun 5, 2023</div></div></div></div></div><div class=mt-6><div class=article><a class=block href=https://rotational.io/blog/real-time-processing/><img src=https://rotational.io/img/blog/starburst.jpg alt class="rounded-t-xl object-cover" style=height:212px;width:100%></a><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Eventing, AI/ML</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/real-time-processing/>Unlocking Real-Time Insights for Data-Driven Success</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>Profitable businesses rely on their own data to grow, make smart choices, and delight their customers. Easier said than done! While a batched approach can provided limited success, real-time data analytics often give better ROI.</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/butterfly.png alt class="rounded-full h-10 w-10">
<span class="ml-4 font-extralight">Faraz Rahman</span></div><div class=font-extralight>May 26, 2023</div></div></div></div></div></div></div></div></div><div class="bg-[#1D65A6] max-w-[800px] mx-auto mt-20 py-14 px-12 md:px-16 text-white md:rounded-lg"><form action=blog method=post id=newsletterForm><h6 class="font-bold text-center">Enter Your Email To Subscribe</h6><label for=email class=hidden>Email</label>
<input type=text name=email id=email required placeholder class="w-full px-4 py-2.5 rounded-lg mt-6 text-black" style=color:#000><div class="flex mt-6 items-start"><input type=checkbox id=checkbox required class="w-6 h-6 block border-0">
<label for=checkbox><span class="ml-2 text-left">I want to receive the monthly newsletter and other updates from Rotational. You agree to our Privacy Policy. You may unsubscribe at any time.*</span></label></div><div class="bg-teal-100 border-t-4 border-teal-500 mt-10 rounded-b text-teal-900 px-4 py-3 shadow-md hidden" id=newsletter-alert role=alert><div class=flex><div><p class=text-sm>Thank you for your interest!</p></div></div></div><div class="flex justify-center"><button type=submit class="bg-[#192E5B] px-14 py-4 mt-10 rounded-lg text-sm text-white uppercase md:text-base">
Submit</button></div></form></div></main><div id=footerBackground><footer class="bg-hero-footer bg-cover"><div class="pt-[350px] font-extralight text-white"><div class="max-w-7xl mx-auto px-6"><div class="max-[650px]:text-center sm:grid grid-cols-4"><div><a href=/><img src=img/footer-otter.png alt class="mx-auto mt-28 sm:mt-0"></a></div><div class="my-10 sm:my-0"><h5 class=mb-3>PRODUCT</h5><ul><li class=pb-3><a href=https://rotational.app target=_blank class=font-bold>Ensign</a></li><li class=pb-3><a href=https://ensign.rotational.dev/getting-started/ target=_blank class=font-bold>Documentation</a></li><li class=pb-3><a href=https://ensign.rotational.dev/sdk/ target=_blank class=font-bold>SDKs</a></li></ul></div><div class="mb-10 sm:mb-0"><h5 class=mb-3>COMPANY</h5><ul><li class=pb-3><a href=/services class=font-bold>Services</a></li><li class=pb-3><a href=/blog class=font-bold>Blog</a></li><li class=pb-3><a href=/opensource class=font-bold>Open Source</a></li><li class=pb-3><a href=/about class=font-bold>About</a></li><li class=pb-3><a href=/contact class=font-bold>Contact Us</a></li></ul></div><div><h5 class=mb-3>INFORMATION</h5><ul><li class=pb-3><a href=/privacy class=font-bold>Privacy</a></li><li class=pb-3><a href=/terms class=font-bold>Terms</a></li></ul></div></div><div class="max-w-7xl sm:flex justify-between border-t py-6 mt-12 sm:mt-32"><div class="mx-auto xl:ml-5 sm:mt-0 mt-8"><div><ul class="mx-auto grid grid-cols-2 gap-x-20 md:gap-x-32 lg:grid-cols-4 xl:ml-20"><li class="pb-8 mt-1"><a href=https://twitter.com/rotationalio class="flex items-center p-2 hover:rounded-full hover:bg-icon-hover" target=_blank><img src=img/footer/twitter.svg alt class=scale-75>
<span class=ml-4>Twitter</span></a></li><li class="pb-8 mt-1"><a href=https://github.com/rotationalio class="flex items-center p-2 hover:rounded-full hover:bg-icon-hover" target=_blank><img src=img/footer/github.svg alt class=scale-[.8]>
<span class=ml-4>GitHub</span></a></li><li class=pb-8><a href=https://www.linkedin.com/company/rotational class="flex items-center p-2 hover:rounded-full hover:bg-icon-hover" target=_blank><img src=img/footer/linkedin.svg alt class=scale-75>
<span class="mt-2 ml-4">LinkedIn</span></a></li><li class="pb-8 mt-2"><a href=mailto:info@rotational.io class="flex items-center p-2 hover:rounded-full hover:bg-icon-hover" target=_blank><img src=img/footer/email.svg alt class=scale-[.8]>
<span class=ml-4>Email</span></a></li></ul></div></div></div><div class="sm:flex justify-between py-6"><p>Copyright Â© Rotational Labs, Inc. 2021â€“2023 Â· All Rights Reserved</p><div><ul class="sm:mt-0 mt-4 flex"><li class="border-r pr-4 mr-4"><a href=/privacy/>Privacy Policy</a></li><li><a href=/terms/>Terms of Use</a></li></ul></div></div></div></div></div></footer></div><script src=https://rotational.io/js/app.js></script>
<script src=https://rotational.io/js/playground-search.js></script>
<script src=https://rotational.io/js/copy-code-button.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.5/flowbite.min.js></script>
<script src=https://unpkg.com/@highlightjs/cdn-assets/highlight.min.js></script></body></html>