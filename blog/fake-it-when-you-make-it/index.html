<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Fake It When You Make It: Creating Mocks in Go</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="A mock is a common pattern for unit testing interdependent services. In this post we will explore creating mocks in Go."><meta name=author content="Rotational Labs, LLC"><meta name=generator content="Hugo 0.83.1"><link rel=stylesheet href=https://rotational.io/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://rotational.io/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://rotational.io/plugins/magnific-popup/magnific-popup.css><link rel=stylesheet href=https://rotational.io/plugins/slick/slick.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Anaheim%7cQuattrocento+Sans:400,700&display=swap"><link rel=stylesheet href=https://rotational.io/css/style.min.css media=screen><link rel=stylesheet href=https://rotational.io/css/custom.min.css media=screen><link rel="shortcut icon" href=https://rotational.io/images/assets/icons/favicon.png type=image/x-icon><link rel=icon href=https://rotational.io/images/assets/icons/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-2FKX6CWJHW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-2FKX6CWJHW')</script></head><body id=body data-spy=scroll data-target=.navbar data-offset=55><div id=content><section class="sticky-top navigation"><div class=container><nav class="navbar navbar-expand-lg navbar-dark"><a class="navbar-brand p-0" href=/><img class=lozad data-src=https://rotational.io/images/assets/logos/logo.png alt="Rotational Labs" height=57></a>
<button class="navbar-toggler rounded-0" type=button data-toggle=collapse data-target=#navigation>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navigation><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://rotational.io/#about>about</a></li><li class=nav-item><a class=nav-link href=https://rotational.io/#services>services</a></li><li class=nav-item><a class=nav-link href=https://rotational.io/#team>team</a></li><li class=nav-item><a class=nav-link href=https://rotational.io/blog>blog</a></li><li class=nav-item><a class=nav-link href=https://rotational.io/#contact>contact</a></li></ul><select id=select-language onchange="location=this.value"><option id=en value=https://rotational.io/blog/fake-it-when-you-make-it/ selected>En</option></select></div></nav></div></section><section class=section><div class=container><div class=row><div class="col-lg-8 offset-lg-2 text-center"><h1>Fake It When You Make It: Creating Mocks in Go</h1><ul class="list-inline mb-50"><li class=list-inline-item><a href=/author/patrick-deziel/>Patrick Deziel</a></li><li class=list-inline-item>Monday, Dec 6, 2021</li></ul><img class="img-fluid mb-50 lozad" data-src=https://rotational.io/images/blog/lake_reflection.jpg alt=blog-image></div><div class="col-lg-8 offset-lg-2"><div class=post-single-content><p>In the age of microservices and containerized applications, software is less monolithic and more interdependent. How do we write tests which account for this new reality? One common strategy is to create mocks for services. In this post, we&rsquo;ll explore some of the challenges with testing in Go and dive into some concrete examples where creating mocks can help alleviate these problems.</p><h2 id=testing-an-existing-codebase>Testing An Existing Codebase</h2><p>As developers we&rsquo;d like to think that we&rsquo;re following test-driven development or at least &ldquo;development with tests&rdquo;. However, sometimes things need to be built quickly or we find ourselves inheriting an existing codebase. How do we write tests without fundamentally changing the source code?</p><p>At Rotational we are interested in building intelligent distributed systems. This adds an additional layer to our testing problem because such projects often involve many dependencies. Consider for example an application that enables decentralized exchange of cryptographic information, which might require external calls to email delivery services and certificate authorities as well as internal calls to token managers, such as the one in the sketch below.</p><p><img src=/images/media/2021-12-06-fake-it-when-you-make-it/crypto.png alt="Cryptographic Information Exchange Service"></p><p>A common strategy for dealing with these dependencies is to use mocks. From a black box perspective a mock imitates the behavior of a service. We use a very generic definition of a service here; in reality it could be an internal or external API, a web server, an external process, or maybe even just a method. At the end of the day we want to be able to test that our code handles the possible scenarios that such a service introduces.</p><h2 id=go-forth-and-mock>Go Forth And Mock</h2><p>In languages like Python, adding unit tests to existing code is fairly straightforward, mostly due to the availability of third party libraries such as <a href=docs.pytests.org>pytest</a>. In addition, the weakly typed nature of Python lends itself to easy mocking. For example, the <a href=https://docs.python.org/3/library/unittest.mock.html>unittest.mock</a> library can be used to replace method calls with calls that return mocked responses (e.g., 200 OK responses to HTTP requests).</p><p>This is in stark constrast with Go, which has some properties which make it more of a challenge to write effective tests. Go is strongly typed, which makes it impossible to swap out variables and methods for mocked types on the fly. In addition, Go makes an important distinction between exported and unexported variables, an analogue to public and private variables in other languages. While this design is useful for protecting variables from unwanted access, it also makes tests more difficult to implement since they usually exist in separate packages from the source code.</p><p>Nevertheless, Go is a popular language for distributed systems and sometimes we need a way to mock things to enable testing. Thankfully, it&rsquo;s possible to create mocks with some effort.</p><p>Suppose we have an <code>EmailManager</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> struct with an associated method that&rsquo;s responsible for sending emails using the <a href=https://sendgrid.com/>SendGrid</a> service.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>type</span> EmailConfig <span style=color:#6ab825;font-weight:700>struct</span> {
    SendGridAPIKey <span style=color:#6ab825;font-weight:700>string</span>
}

<span style=color:#6ab825;font-weight:700>type</span> EmailManager <span style=color:#6ab825;font-weight:700>struct</span> {
	client sendgrid.Client
}

<span style=color:#6ab825;font-weight:700>func</span> <span style=color:#447fcf>New</span>(conf EmailConfig) *EmailManager {
	<span style=color:#6ab825;font-weight:700>return</span> &amp;EmailManager{
        client: sendgrid.<span style=color:#447fcf>NewSendClient</span>(conf.SendGridAPIKey),
    }
}

<span style=color:#6ab825;font-weight:700>func</span> (m *EmailManager) <span style=color:#447fcf>SendEmail</span>(message *mail.SGMailV3) (err <span style=color:#6ab825;font-weight:700>error</span>) {
	<span style=color:#6ab825;font-weight:700>var</span> rep *rest.Response
	<span style=color:#6ab825;font-weight:700>if</span> rep, err = m.client.<span style=color:#447fcf>Send</span>(message); err != <span style=color:#6ab825;font-weight:700>nil</span> {
		<span style=color:#6ab825;font-weight:700>return</span> err
	}

	<span style=color:#6ab825;font-weight:700>if</span> rep.StatusCode &lt; <span style=color:#3677a9>200</span> || rep.StatusCode &gt;= <span style=color:#3677a9>300</span> {
		<span style=color:#6ab825;font-weight:700>return</span> errors.<span style=color:#447fcf>New</span>(rep.Body)
	}

	<span style=color:#6ab825;font-weight:700>return</span> <span style=color:#6ab825;font-weight:700>nil</span>
}
</code></pre></div><p>We want to test that the <code>SendEmail</code> method is correctly interacting with the SendGrid API. One option for testing the success path is to give SendGrid a real API key and an email address designated for testing. However, this complicates our testing devops and creates an external testing dependency on SendGrid. A more attractive option might be to mock the behavior of the SendGrid client entirely in code<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. This would have the benefit of allowing us to test the success path without the extra configuration or dependency headaches.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>type</span> mockSendGridClient <span style=color:#6ab825;font-weight:700>struct</span>{}

<span style=color:#6ab825;font-weight:700>func</span> (c *mockSendGridClient) <span style=color:#447fcf>Send</span>(message *mail.SGMailV3) (rep *rest.Response, err <span style=color:#6ab825;font-weight:700>error</span>) {
    <span style=color:#6ab825;font-weight:700>return</span> &amp;rest.Response{StatusCode: http.StatusOK}, <span style=color:#6ab825;font-weight:700>nil</span>
}
</code></pre></div><p>Now that we have a mock that returns a successful REST response, all we need to do is swap the real SendGrid client out for the mock during the test. We can utilize a Go interface to accomplish this.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>type</span> EmailManager <span style=color:#6ab825;font-weight:700>struct</span> {
	client EmailClient
}

<span style=color:#6ab825;font-weight:700>type</span> EmailClient <span style=color:#6ab825;font-weight:700>interface</span> {
	<span style=color:#447fcf>Send</span>(email *sgmail.SGMailV3) (*rest.Response, <span style=color:#6ab825;font-weight:700>error</span>)
}
</code></pre></div><p>What we&rsquo;ve done here is defined a generic <code>EmailClient</code> interface which defines a <code>Send</code> function. Since our <code>mockSendGridClient</code> and the real <code>sendGrid.Client</code> both implement this function, this allows us to set <code>EmailManager.client</code> to an instance of either of them depending on if we are testing or in production.</p><p>There is one final complication to resolve. Since <code>EmailManager.client</code> is unexported, we won&rsquo;t be able to reference it from the test package. One way to solve this is to push the problem onto configuration with a <code>Testing</code> flag.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>type</span> EmailConfig <span style=color:#6ab825;font-weight:700>struct</span> {
    SendGridAPIKey <span style=color:#6ab825;font-weight:700>string</span>
}

<span style=color:#6ab825;font-weight:700>func</span> <span style=color:#447fcf>New</span>(conf config.EmailConfig) (m *EmailManager) {
	m = &amp;EmailManager{conf: conf}
	<span style=color:#6ab825;font-weight:700>if</span> conf.Testing {
		m.client = &amp;mockSendGridClient{}
	} <span style=color:#6ab825;font-weight:700>else</span> {
		m.client = sendgrid.<span style=color:#447fcf>NewSendClient</span>(conf.SendGridAPIKey)
	}
	<span style=color:#6ab825;font-weight:700>return</span> m, <span style=color:#6ab825;font-weight:700>nil</span>
}
</code></pre></div><p>As we see below, this allows us to write a test which closely approximates reality, since the <code>EmailCient</code> is invoked and used the same way in testing and production, just with a different configuration.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>func</span> <span style=color:#447fcf>TestSendEmail</span>(t *testing.T) {
    message := mail.<span style=color:#447fcf>NewSingleEmail</span>(
        mail.<span style=color:#447fcf>NewEmail</span>(<span style=color:#ed9d13>&#34;sender&#34;</span>, <span style=color:#ed9d13>&#34;emailtesting@rotational.io&#34;</span>),
        VerifyContactRE,
        mail.<span style=color:#447fcf>NewEmail</span>(<span style=color:#ed9d13>&#34;recipient&#34;</span>, <span style=color:#ed9d13>&#34;emailtesting@rotational.io&#34;</span>),
        <span style=color:#ed9d13>&#34;test email&#34;</span>,
        <span style=color:#6ab825;font-weight:700>nil</span>
    )
    conf := email.EmailConfig{
        Testing: <span style=color:#6ab825;font-weight:700>true</span>,
    }
    em := emails.<span style=color:#447fcf>New</span>(conf)
    rep, err := em.<span style=color:#447fcf>SendEmail</span>(message)
    require.<span style=color:#447fcf>NoError</span>(t, err)
    require.<span style=color:#447fcf>Equal</span>(http.StatusOK, rep.StatusCode)
}
</code></pre></div><h2 id=when-is-a-mock-not-a-mock>When Is A Mock Not A Mock?</h2><p>The email mock we&rsquo;ve defined above is very barebones; it has the mimimum amount of code required to test the success path of <code>SendEmail</code>. Of course, the real SendGrid does a lot more than send back an HTTP response, since it has to marshal the email message into bytes, create the actual HTTP request, and wait for the response. This raises a bit of an existential question of what a mock is. Is it a method for bypassing code during tests or a full reimplementation of a service? Most of the time, we are interested in some middle ground between the two. For example, in the previous section we might have found it useful to add some simple validation to the mock, so that we can still catch error cases where we are creating badly formatted email messages (e.g, missing To or From addresses).</p><p>For most situations, reimplementing an entire service just so we can avoid the dependency and overhead of calling the real one is probably not worth our time. For example, services like the <a href=https://sectigo.com/resource-library/sectigo-certificate-manager>Sectigo Certificate Manager</a> have extensive REST APIs and it would be difficult to handle all the edge cases. However, we may find it useful to define the mock<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> as a test server which by default returns the &ldquo;good&rdquo; responses to all the endpoint calls.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>type</span> Server <span style=color:#6ab825;font-weight:700>struct</span> {
	server   *httptest.Server
	router   *gin.Engine
	handlers <span style=color:#6ab825;font-weight:700>map</span>[<span style=color:#6ab825;font-weight:700>string</span>]gin.HandlerFunc
	calls    <span style=color:#6ab825;font-weight:700>map</span>[<span style=color:#6ab825;font-weight:700>string</span>]<span style=color:#6ab825;font-weight:700>int</span>
}

<span style=color:#999;font-style:italic>// New initializes a new server which mocks the Sectigo REST API.
</span><span style=color:#999;font-style:italic></span><span style=color:#6ab825;font-weight:700>func</span> <span style=color:#447fcf>New</span>() (s *Server, err <span style=color:#6ab825;font-weight:700>error</span>) {
	gin.<span style=color:#447fcf>SetMode</span>(gin.TestMode)

	s = &amp;Server{
		handlers: <span style=color:#24909d>make</span>(<span style=color:#6ab825;font-weight:700>map</span>[<span style=color:#6ab825;font-weight:700>string</span>]gin.HandlerFunc),
		router:   gin.<span style=color:#447fcf>New</span>(),
		calls:    <span style=color:#24909d>make</span>(<span style=color:#6ab825;font-weight:700>map</span>[<span style=color:#6ab825;font-weight:700>string</span>]<span style=color:#6ab825;font-weight:700>int</span>),
	}

	s.<span style=color:#447fcf>Handle</span>(sectigo.AuthenticateEP, http.MethodPost, s.authenticate)
	s.server = httptest.<span style=color:#447fcf>NewServer</span>(s.router)
	sectigo.<span style=color:#447fcf>SetBaseURL</span>(s.<span style=color:#447fcf>URL</span>())
	<span style=color:#6ab825;font-weight:700>return</span> s, <span style=color:#6ab825;font-weight:700>nil</span>
}

<span style=color:#999;font-style:italic>// Close the test server to complete the tests and cleanup.
</span><span style=color:#999;font-style:italic></span><span style=color:#6ab825;font-weight:700>func</span> (s *Server) <span style=color:#447fcf>Close</span>() {
	s.server.<span style=color:#447fcf>Close</span>()
	sectigo.<span style=color:#447fcf>ResetBaseURL</span>()
}

<span style=color:#999;font-style:italic>// Handle is a helper function that adds a handler to the mock server&#39;s handlers map and
</span><span style=color:#999;font-style:italic>// returns that handler function when the endpoint is called.
</span><span style=color:#999;font-style:italic></span><span style=color:#6ab825;font-weight:700>func</span> (s *Server) <span style=color:#447fcf>Handle</span>(endpoint <span style=color:#6ab825;font-weight:700>string</span>, handler gin.HandlerFunc) <span style=color:#6ab825;font-weight:700>error</span> {
	<span style=color:#6ab825;font-weight:700>if</span> _, ok := s.handlers[endpoint]; !ok {
		<span style=color:#6ab825;font-weight:700>return</span> fmt.<span style=color:#447fcf>Errorf</span>(<span style=color:#ed9d13>&#34;unhandled endpoint %s&#34;</span>, endpoint)
	}
	s.handlers[endpoint] = handler
	<span style=color:#6ab825;font-weight:700>return</span> <span style=color:#6ab825;font-weight:700>nil</span>
}

<span style=color:#999;font-style:italic>// URL returns the URL of the test server.
</span><span style=color:#999;font-style:italic></span><span style=color:#6ab825;font-weight:700>func</span> (s *Server) <span style=color:#447fcf>URL</span>() *url.URL {
	u, err := url.<span style=color:#447fcf>Parse</span>(s.server.URL)
	<span style=color:#6ab825;font-weight:700>if</span> err != <span style=color:#6ab825;font-weight:700>nil</span> {
		<span style=color:#24909d>panic</span>(err)
	}
	<span style=color:#6ab825;font-weight:700>return</span> u
}

<span style=color:#999;font-style:italic>// Handler for a &#34;successful&#34; authentication call.
</span><span style=color:#999;font-style:italic></span><span style=color:#6ab825;font-weight:700>func</span> (s *Server) <span style=color:#447fcf>authenticate</span>(c *gin.Context) {
	<span style=color:#6ab825;font-weight:700>var</span> (
		in      *sectigo.AuthenticationRequest
		access  <span style=color:#6ab825;font-weight:700>string</span>
		refresh <span style=color:#6ab825;font-weight:700>string</span>
		err     <span style=color:#6ab825;font-weight:700>error</span>
	)
	s.calls[sectigo.AuthenticateEP]++
	<span style=color:#6ab825;font-weight:700>if</span> err = c.<span style=color:#447fcf>BindJSON</span>(&amp;in); err != <span style=color:#6ab825;font-weight:700>nil</span> {
		c.<span style=color:#447fcf>JSON</span>(http.StatusBadRequest, err)
		<span style=color:#6ab825;font-weight:700>return</span>
	}
	<span style=color:#6ab825;font-weight:700>if</span> access, err = <span style=color:#447fcf>generateToken</span>(); err != <span style=color:#6ab825;font-weight:700>nil</span> {
		c.<span style=color:#447fcf>JSON</span>(http.StatusInternalServerError, err)
		<span style=color:#6ab825;font-weight:700>return</span>
	}
	<span style=color:#6ab825;font-weight:700>if</span> refresh, err = <span style=color:#447fcf>generateToken</span>(); err != <span style=color:#6ab825;font-weight:700>nil</span> {
		c.<span style=color:#447fcf>JSON</span>(http.StatusInternalServerError, err)
		<span style=color:#6ab825;font-weight:700>return</span>
	}
	c.<span style=color:#447fcf>JSON</span>(http.StatusOK, &amp;sectigo.AuthenticationReply{
		AccessToken:  access,
		RefreshToken: refresh,
	})
}
</code></pre></div><p>There are a few things going on here. We are using <code>httptest</code> and <code>gin</code> to quickly spin up a test server and configure an endpoint to our mocked <code>authenticate</code> handler. We also call the project-specific method <code>sectigo.SetBaseURL</code> to ensure that all the Sectigo requests get directed to our mock. In the mocked <code>authenticate</code> handler, we simply generate some valid-looking JWT tokens and send them back in the request so our Sectigo client code hits the &ldquo;success&rdquo; path. Finally, we have a call counter which helps verify that the correct endpoints are being called. This infrastructure enables us to write a simple test<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> for our Sectigo client <code>Authenticate</code> method.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>func</span> <span style=color:#447fcf>TestAuthenticate</span>(t *testing.T) {
    m, err := mock.<span style=color:#447fcf>New</span>()
    require.<span style=color:#447fcf>NoError</span>(t, err)
    <span style=color:#6ab825;font-weight:700>defer</span> m.<span style=color:#447fcf>Close</span>()
    s.api, err = <span style=color:#447fcf>NewSectigoClient</span>(<span style=color:#ed9d13>&#34;foo&#34;</span>, <span style=color:#ed9d13>&#34;supersecret&#34;</span>)
    require.<span style=color:#447fcf>NoError</span>(t, err)
	require.<span style=color:#447fcf>NoError</span>(t, s.api.<span style=color:#447fcf>Authenticate</span>())
}
</code></pre></div><p>What happens if we run into an edge case we want to add a test for? With the mock we&rsquo;ve set up, this is actually pretty straightforward. For example, if we want to test that our Sectigo client is handling invalid credentials properly, we can replace the mock <code>authenticate</code> handler with one that has validation logic.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#6ab825;font-weight:700>func</span> <span style=color:#447fcf>TestAuthenticateInvalidCreds</span>() {
	m, err := mock.<span style=color:#447fcf>New</span>()
	require.<span style=color:#447fcf>NoError</span>(t, err)
	<span style=color:#6ab825;font-weight:700>defer</span> m.<span style=color:#447fcf>Close</span>()

	m.<span style=color:#447fcf>Handle</span>(AuthenticateEP, <span style=color:#6ab825;font-weight:700>func</span>(c *gin.Context) {
		<span style=color:#6ab825;font-weight:700>var</span> (
			in *AuthenticationRequest
		)
		<span style=color:#6ab825;font-weight:700>if</span> err := c.<span style=color:#447fcf>BindJSON</span>(&amp;in); err != <span style=color:#6ab825;font-weight:700>nil</span> {
			c.<span style=color:#447fcf>JSON</span>(http.StatusBadRequest, err)
			<span style=color:#6ab825;font-weight:700>return</span>
		}
		<span style=color:#6ab825;font-weight:700>if</span> in.Username != <span style=color:#ed9d13>&#34;foo&#34;</span> || in.Password != <span style=color:#ed9d13>&#34;supersecret&#34;</span> {
			c.<span style=color:#447fcf>JSON</span>(http.StatusUnauthorized, <span style=color:#ed9d13>&#34;invalid credentials&#34;</span>)
			<span style=color:#6ab825;font-weight:700>return</span>
		}

		c.<span style=color:#447fcf>JSON</span>(http.StatusInternalServerError, <span style=color:#ed9d13>&#34;how did we get here?&#34;</span>)
	})

	s.api, err = <span style=color:#447fcf>New</span>(<span style=color:#ed9d13>&#34;invalid&#34;</span>, <span style=color:#ed9d13>&#34;invalid&#34;</span>)
	require.<span style=color:#447fcf>NoError</span>(t, err)
	err = s.api.<span style=color:#447fcf>Authenticate</span>()
	require.<span style=color:#447fcf>EqualError</span>(t, err, ErrInvalidCredentials.<span style=color:#447fcf>Error</span>())
}
</code></pre></div><h2 id=conclusion>Conclusion</h2><p>Testing distributed systems applications is difficult due to the many interdependencies involved and the design of programming languages such as Go. In this post, we&rsquo;ve looked at a few examples of how mocks can be used to alleviate some of these pain points.</p><p>Mocks can help us bypass code that we don&rsquo;t want to run in our tests without fundamentally changing the architecture of our applications. With some configuration, mocks allow us to test both the success and error paths of our service-dependent code, enabling more complete unit testing, and a greater degree of confidence in the implemention of highly complex systems.</p><hr><p>Photo by <a href="https://unsplash.com/@davehoefler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Dave Hoefler</a> on <a href="https://unsplash.com/s/photos/pond-reflection?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a></p><h4 id=code-references>Code References</h4><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/gds/emails/client.go>Email Manager</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/gds/emails/mock.go>SendGrid mock</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/sectigo/mock/mock.go>Sectigo mock</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/sectigo/sectigo_test.go>Sectigo client tests</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class="social-share pt-4"><h4>Share:</h4><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Fake%20It%20When%20You%20Make%20It%3a%20Creating%20Mocks%20in%20Go&url=https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://plus.google.com/share?url=https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.37 12.93c-.73-.52-1.4-1.27-1.4-1.5.0-.43.03-.63.98-1.37 1.23-.97 1.9-2.23 1.9-3.57.0-1.22-.36-2.3-1-3.05h.5c.1.0.2-.04.28-.1l1.36-.98c.16-.12.23-.34.17-.54-.07-.2-.25-.33-.46-.33H7.6c-.66.0-1.34.12-2 .35-2.23.76-3.78 2.66-3.78 4.6.0 2.76 2.13 4.85 5 4.9-.07.23-.1.45-.1.66.0.43.1.83.33 1.22h-.08c-2.72.0-5.17 1.34-6.1 3.32-.25.52-.37 1.04-.37 1.56.0.5.13.98.38 1.44.6 1.04 1.84 1.86 3.55 2.28.87.23 1.82.34 2.8.34.88.0 1.7-.1 2.5-.34 2.4-.7 3.97-2.48 3.97-4.54.0-1.97-.63-3.15-2.33-4.35zm-7.7 4.5c0-1.42 1.8-2.68 3.9-2.68h.05c.45.0.9.07 1.3.2l.42.28c.96.66 1.6 1.1 1.77 1.8.05.16.07.33.07.5.0 1.8-1.33 2.7-3.96 2.7-1.98.0-3.54-1.23-3.54-2.8zM5.54 3.9c.33-.38.75-.58 1.23-.58h.05c1.35.05 2.64 1.55 2.88 3.35.14 1.02-.08 1.97-.6 2.55-.32.37-.74.56-1.23.56h-.03c-1.32-.04-2.63-1.6-2.87-3.4-.13-1 .08-1.92.58-2.5zM23.5 9.5h-3v-3h-2v3h-3v2h3v3h2v-3h3"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Fake%20It%20When%20You%20Make%20It%3a%20Creating%20Mocks%20in%20Go&body=https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f&resubmit=true&title=Fake%20It%20When%20You%20Make%20It%3a%20Creating%20Mocks%20in%20Go" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Fake%20It%20When%20You%20Make%20It%3a%20Creating%20Mocks%20in%20Go%20https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3.0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7.0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1.0-5.2 4.2-9.4 9.4-9.4 2.5.0 4.9 1 6.7 2.8s2.8 4.2 2.8 6.7c-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2s0-.5.1-.6.3-.3.4-.5c.2-.1.3-.3.4-.5s0-.4.0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Fake%20It%20When%20You%20Make%20It%3a%20Creating%20Mocks%20in%20Go&url=https%3a%2f%2frotational.io%2fblog%2ffake-it-when-you-make-it%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64.0 9.508.0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102.0 001.75.527l2.96-2.41a.405.405.0 01.494-.013l5.34 3.87a1.1 1.1.0 001.046.135 1.1 1.1.0 00.682-.803l3.91-18.795A1.102 1.102.0 0022.5.075L.706 8.475z"/></svg></div></div></a></div><div class=mt-5></div></div></div></div></section></div><footer id=footer class=section-bg><div class=container><div class="row wow fadeInUp" data-wow-duration=500ms><div class=col-xl-12><div class=social-icon><ul class=list-inline><li class=list-inline-item><a href=https://twitter.com/rotationalio target=_blank><i class=ti-twitter-alt></i></a></li><li class=list-inline-item><a href=https://github.com/rotationalio target=_blank><i class=ti-github></i></a></li><li class=list-inline-item><a href=https://www.linkedin.com/company/rotational/ target=_blank><i class=ti-linkedin></i></a></li></ul></div><div class="copyright text-center"><a href=https://rotational.io/><img src=https://rotational.io/images/assets/logos/logo.png alt="Rotational Labs" height=92></a><br><p>Copyright © 2021 Rotational Labs, LLC, All Rights Reserved</p></div></div></div></div></footer><script src=https://rotational.io/plugins/jquery/jquery.min.js></script><script src=https://rotational.io/plugins/bootstrap/bootstrap.min.js></script><script src=https://rotational.io/plugins/slick/slick.min.js></script><script src=https://rotational.io/plugins/shuffle/shuffle.min.js></script><script src=https://rotational.io/plugins/magnific-popup/jquery.magnific-popup.min.js></script><script src=https://rotational.io/plugins/lazy-load/lozad.min.js></script><script src=https://rotational.io/plugins/google-map/map.js></script><script src=https://rotational.io/js/script.min.5db5ae6f88052715e823d7c52f3fa7a832565352b0f76c1d2cee2a3b564a0716fa9d51878a9965389c3d856f2d7c6330.js integrity=sha384-XbWub4gFJxXoI9fFLz+nqDJWU1Kw92wdLO4qO1ZKBxb6nVGHipllOJw9hW8tfGMw></script></body></html>