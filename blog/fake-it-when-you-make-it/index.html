<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A mock is a common pattern for unit testing interdependent services. In this post we will explore creating mocks in Go."><meta name=author content="Rotational Labs, LLC"><base href=https://rotational.io/><title>Rotational Labs | Fake It When You Make It: Creating Mocks in Go</title><link rel="shortcut icon" href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=icon href=https://rotational.io/img/favicon.png type=image/x-icon><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=https://rotational.io/output.css media=screen><script async src="https://www.googletagmanager.com/gtag/js?id=G-2FKX6CWJHW"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2FKX6CWJHW")</script></head><body class=bg-white><div class="sm:pt-5 pb-6 relative bg-[#1D65A6]"><nav class="relative max-w-7xl mx-auto flex items-center justify-between text-white px-4 sm:px-6" aria-label=Global><a href=/ class="pt-3 sm:pt-0"><img src=img/logo.png alt="Rotational Lab logo" class="h-14 w-auto sm:h-14"></a><div class=topnav id=myTopnav><a href=https://rotational.app>Ensign</a>
<a href=/services/>Services</a>
<a href=/blog/>Blog</a>
<a href=/about/>About</a>
<a href=/contact/>Contact Us</a>
<a href=javascript:void(0); class=icon onclick=myFunction()><i class="fa fa-bars"></i></a></div></nav></div><main><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class=mt-14><div class=blog-img><img src=https://rotational.io/img/blog/lake_reflection.jpg alt="Fake It When You Make It: Creating Mocks in Go" class=mx-auto></div><div class=mt-8><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl text-center"><b class=text-[#1D65A6]>Fake</b>
It When You Make It: Creating Mocks in Go</h3><div class="flex justify-center items-center mt-4 mb-6"><img src=img/team/patrick%20deziel.png alt class="border-4 border-white rounded-full h-11 drop-shadow-lg"><span class=ml-3>Patrick Deziel |
Monday, Dec 6, 2021 |</span></div><div class="max-w-[800px] mx-auto prose prose-blue"><p>In the age of microservices and containerized applications, software is less monolithic and more interdependent. How do we write tests which account for this new reality? One common strategy is to create mocks for services. In this post, we&rsquo;ll explore some of the challenges with testing in Go and dive into some concrete examples where creating mocks can help alleviate these problems.</p><h2 id=testing-an-existing-codebase>Testing An Existing Codebase</h2><p>As developers we&rsquo;d like to think that we&rsquo;re following test-driven development or at least &ldquo;development with tests&rdquo;. However, sometimes things need to be built quickly or we find ourselves inheriting an existing codebase. How do we write tests without fundamentally changing the source code?</p><p>At Rotational we are interested in building intelligent distributed systems. This adds an additional layer to our testing problem because such projects often involve many dependencies. Consider for example an application that enables decentralized exchange of cryptographic information, which might require external calls to email delivery services and certificate authorities as well as internal calls to token managers, such as the one in the sketch below.</p><p><img src=/img/blog/2021-12-06-fake-it-when-you-make-it/crypto.png alt="Cryptographic Information Exchange Service"></p><p>A common strategy for dealing with these dependencies is to use mocks. From a black box perspective a mock imitates the behavior of a service. We use a very generic definition of a service here; in reality it could be an internal or external API, a web server, an external process, or maybe even just a method. At the end of the day we want to be able to test that our code handles the possible scenarios that such a service introduces.</p><h2 id=go-forth-and-mock>Go Forth And Mock</h2><p>In languages like Python, adding unit tests to existing code is fairly straightforward, mostly due to the availability of third party libraries such as <a href=docs.pytests.org>pytest</a>. In addition, the weakly typed nature of Python lends itself to easy mocking. For example, the <a href=https://docs.python.org/3/library/unittest.mock.html>unittest.mock</a> library can be used to replace method calls with calls that return mocked responses (e.g., 200 OK responses to HTTP requests).</p><p>This is in stark constrast with Go, which has some properties which make it more of a challenge to write effective tests. Go is strongly typed, which makes it impossible to swap out variables and methods for mocked types on the fly. In addition, Go makes an important distinction between exported and unexported variables, an analogue to public and private variables in other languages. While this design is useful for protecting variables from unwanted access, it also makes tests more difficult to implement since they usually exist in separate packages from the source code.</p><p>Nevertheless, Go is a popular language for distributed systems and sometimes we need a way to mock things to enable testing. Thankfully, it&rsquo;s possible to create mocks with some effort.</p><p>Suppose we have an <code>EmailManager</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> struct with an associated method that&rsquo;s responsible for sending emails using the <a href=https://sendgrid.com/>SendGrid</a> service.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailConfig</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SendGridAPIKey</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailManager</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>client</span> <span style=color:#a6e22e>sendgrid</span>.<span style=color:#a6e22e>Client</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>conf</span> <span style=color:#a6e22e>EmailConfig</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailManager</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>EmailManager</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>client</span>: <span style=color:#a6e22e>sendgrid</span>.<span style=color:#a6e22e>NewSendClient</span>(<span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>SendGridAPIKey</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>m</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailManager</span>) <span style=color:#a6e22e>SendEmail</span>(<span style=color:#a6e22e>message</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>mail</span>.<span style=color:#a6e22e>SGMailV3</span>) (<span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rep</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>rest</span>.<span style=color:#a6e22e>Response</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>rep</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>message</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>rep</span>.<span style=color:#a6e22e>StatusCode</span> &lt; <span style=color:#ae81ff>200</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>rep</span>.<span style=color:#a6e22e>StatusCode</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>300</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>rep</span>.<span style=color:#a6e22e>Body</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We want to test that the <code>SendEmail</code> method is correctly interacting with the SendGrid API. One option for testing the success path is to give SendGrid a real API key and an email address designated for testing. However, this complicates our testing devops and creates an external testing dependency on SendGrid. A more attractive option might be to mock the behavior of the SendGrid client entirely in code<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. This would have the benefit of allowing us to test the success path without the extra configuration or dependency headaches.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>mockSendGridClient</span> <span style=color:#66d9ef>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>mockSendGridClient</span>) <span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>message</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>mail</span>.<span style=color:#a6e22e>SGMailV3</span>) (<span style=color:#a6e22e>rep</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>rest</span>.<span style=color:#a6e22e>Response</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>rest</span>.<span style=color:#a6e22e>Response</span>{<span style=color:#a6e22e>StatusCode</span>: <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusOK</span>}, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now that we have a mock that returns a successful REST response, all we need to do is swap the real SendGrid client out for the mock during the test. We can utilize a Go interface to accomplish this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailManager</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>client</span> <span style=color:#a6e22e>EmailClient</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailClient</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>email</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>sgmail</span>.<span style=color:#a6e22e>SGMailV3</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>rest</span>.<span style=color:#a6e22e>Response</span>, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>What we&rsquo;ve done here is defined a generic <code>EmailClient</code> interface which defines a <code>Send</code> function. Since our <code>mockSendGridClient</code> and the real <code>sendGrid.Client</code> both implement this function, this allows us to set <code>EmailManager.client</code> to an instance of either of them depending on if we are testing or in production.</p><p>There is one final complication to resolve. Since <code>EmailManager.client</code> is unexported, we won&rsquo;t be able to reference it from the test package. One way to solve this is to push the problem onto configuration with a <code>Testing</code> flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>EmailConfig</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>SendGridAPIKey</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>conf</span> <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>EmailConfig</span>) (<span style=color:#a6e22e>m</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>EmailManager</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>m</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>EmailManager</span>{<span style=color:#a6e22e>conf</span>: <span style=color:#a6e22e>conf</span>}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>Testing</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>client</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>mockSendGridClient</span>{}
</span></span><span style=display:flex><span>	} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>client</span> = <span style=color:#a6e22e>sendgrid</span>.<span style=color:#a6e22e>NewSendClient</span>(<span style=color:#a6e22e>conf</span>.<span style=color:#a6e22e>SendGridAPIKey</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>m</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As we see below, this allows us to write a test which closely approximates reality, since the <code>EmailCient</code> is invoked and used the same way in testing and production, just with a different configuration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>TestSendEmail</span>(<span style=color:#a6e22e>t</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>testing</span>.<span style=color:#a6e22e>T</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>message</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>mail</span>.<span style=color:#a6e22e>NewSingleEmail</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mail</span>.<span style=color:#a6e22e>NewEmail</span>(<span style=color:#e6db74>&#34;sender&#34;</span>, <span style=color:#e6db74>&#34;emailtesting@rotational.io&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>VerifyContactRE</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>mail</span>.<span style=color:#a6e22e>NewEmail</span>(<span style=color:#e6db74>&#34;recipient&#34;</span>, <span style=color:#e6db74>&#34;emailtesting@rotational.io&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;test email&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conf</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>email</span>.<span style=color:#a6e22e>EmailConfig</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Testing</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>em</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>emails</span>.<span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>conf</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rep</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>em</span>.<span style=color:#a6e22e>SendEmail</span>(<span style=color:#a6e22e>message</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>NoError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>Equal</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusOK</span>, <span style=color:#a6e22e>rep</span>.<span style=color:#a6e22e>StatusCode</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=when-is-a-mock-not-a-mock>When Is A Mock Not A Mock?</h2><p>The email mock we&rsquo;ve defined above is very barebones; it has the mimimum amount of code required to test the success path of <code>SendEmail</code>. Of course, the real SendGrid does a lot more than send back an HTTP response, since it has to marshal the email message into bytes, create the actual HTTP request, and wait for the response. This raises a bit of an existential question of what a mock is. Is it a method for bypassing code during tests or a full reimplementation of a service? Most of the time, we are interested in some middle ground between the two. For example, in the previous section we might have found it useful to add some simple validation to the mock, so that we can still catch error cases where we are creating badly formatted email messages (e.g, missing To or From addresses).</p><p>For most situations, reimplementing an entire service just so we can avoid the dependency and overhead of calling the real one is probably not worth our time. For example, services like the <a href=https://sectigo.com/resource-library/sectigo-certificate-manager>Sectigo Certificate Manager</a> have extensive REST APIs and it would be difficult to handle all the edge cases. However, we may find it useful to define the mock<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> as a test server which by default returns the &ldquo;good&rdquo; responses to all the endpoint calls.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Server</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>server</span>   <span style=color:#f92672>*</span><span style=color:#a6e22e>httptest</span>.<span style=color:#a6e22e>Server</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>router</span>   <span style=color:#f92672>*</span><span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>Engine</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>handlers</span> <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>HandlerFunc</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>calls</span>    <span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// New initializes a new server which mocks the Sectigo REST API.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>New</span>() (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Server</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>SetMode</span>(<span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>TestMode</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Server</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>handlers</span>: make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>HandlerFunc</span>),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>router</span>:   <span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>New</span>(),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>calls</span>:    make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>]<span style=color:#66d9ef>int</span>),
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>Handle</span>(<span style=color:#a6e22e>sectigo</span>.<span style=color:#a6e22e>AuthenticateEP</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>MethodPost</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>authenticate</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>server</span> = <span style=color:#a6e22e>httptest</span>.<span style=color:#a6e22e>NewServer</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>router</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sectigo</span>.<span style=color:#a6e22e>SetBaseURL</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>URL</span>())
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>s</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Close the test server to complete the tests and cleanup.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Server</span>) <span style=color:#a6e22e>Close</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>server</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>sectigo</span>.<span style=color:#a6e22e>ResetBaseURL</span>()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Handle is a helper function that adds a handler to the mock server&#39;s handlers map and
</span></span></span><span style=display:flex><span><span style=color:#75715e>// returns that handler function when the endpoint is called.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Server</span>) <span style=color:#a6e22e>Handle</span>(<span style=color:#a6e22e>endpoint</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>handler</span> <span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>HandlerFunc</span>) <span style=color:#66d9ef>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>handlers</span>[<span style=color:#a6e22e>endpoint</span>]; !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;unhandled endpoint %s&#34;</span>, <span style=color:#a6e22e>endpoint</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>handlers</span>[<span style=color:#a6e22e>endpoint</span>] = <span style=color:#a6e22e>handler</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// URL returns the URL of the test server.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Server</span>) <span style=color:#a6e22e>URL</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>URL</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>u</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>server</span>.<span style=color:#a6e22e>URL</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>u</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Handler for a &#34;successful&#34; authentication call.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Server</span>) <span style=color:#a6e22e>authenticate</span>(<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>Context</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> (
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>in</span>      <span style=color:#f92672>*</span><span style=color:#a6e22e>sectigo</span>.<span style=color:#a6e22e>AuthenticationRequest</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>access</span>  <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>refresh</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>err</span>     <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>calls</span>[<span style=color:#a6e22e>sectigo</span>.<span style=color:#a6e22e>AuthenticateEP</span>]<span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>BindJSON</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>in</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusBadRequest</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>access</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>generateToken</span>(); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusInternalServerError</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>refresh</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>generateToken</span>(); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusInternalServerError</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusOK</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>sectigo</span>.<span style=color:#a6e22e>AuthenticationReply</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>AccessToken</span>:  <span style=color:#a6e22e>access</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>RefreshToken</span>: <span style=color:#a6e22e>refresh</span>,
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>There are a few things going on here. We are using <code>httptest</code> and <code>gin</code> to quickly spin up a test server and configure an endpoint to our mocked <code>authenticate</code> handler. We also call the project-specific method <code>sectigo.SetBaseURL</code> to ensure that all the Sectigo requests get directed to our mock. In the mocked <code>authenticate</code> handler, we simply generate some valid-looking JWT tokens and send them back in the request so our Sectigo client code hits the &ldquo;success&rdquo; path. Finally, we have a call counter which helps verify that the correct endpoints are being called. This infrastructure enables us to write a simple test<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> for our Sectigo client <code>Authenticate</code> method.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>TestAuthenticate</span>(<span style=color:#a6e22e>t</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>testing</span>.<span style=color:#a6e22e>T</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>m</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>mock</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>NoError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>api</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>NewSectigoClient</span>(<span style=color:#e6db74>&#34;foo&#34;</span>, <span style=color:#e6db74>&#34;supersecret&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>NoError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>NoError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>Authenticate</span>())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>What happens if we run into an edge case we want to add a test for? With the mock we&rsquo;ve set up, this is actually pretty straightforward. For example, if we want to test that our Sectigo client is handling invalid credentials properly, we can replace the mock <code>authenticate</code> handler with one that has validation logic.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>TestAuthenticateInvalidCreds</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>m</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>mock</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>NoError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>Handle</span>(<span style=color:#a6e22e>AuthenticateEP</span>, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>Context</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> (
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>in</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>AuthenticationRequest</span>
</span></span><span style=display:flex><span>		)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>BindJSON</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>in</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusBadRequest</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>in</span>.<span style=color:#a6e22e>Username</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;foo&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>in</span>.<span style=color:#a6e22e>Password</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;supersecret&#34;</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusUnauthorized</span>, <span style=color:#e6db74>&#34;invalid credentials&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>JSON</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusInternalServerError</span>, <span style=color:#e6db74>&#34;how did we get here?&#34;</span>)
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>api</span>, <span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>New</span>(<span style=color:#e6db74>&#34;invalid&#34;</span>, <span style=color:#e6db74>&#34;invalid&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>NoError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>err</span> = <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>Authenticate</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>require</span>.<span style=color:#a6e22e>EqualError</span>(<span style=color:#a6e22e>t</span>, <span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>ErrInvalidCredentials</span>.<span style=color:#a6e22e>Error</span>())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>Testing distributed systems applications is difficult due to the many interdependencies involved and the design of programming languages such as Go. In this post, we&rsquo;ve looked at a few examples of how mocks can be used to alleviate some of these pain points.</p><p>Mocks can help us bypass code that we don&rsquo;t want to run in our tests without fundamentally changing the architecture of our applications. With some configuration, mocks allow us to test both the success and error paths of our service-dependent code, enabling more complete unit testing, and a greater degree of confidence in the implemention of highly complex systems.</p><hr><p>Photo by <a href="https://unsplash.com/@davehoefler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Dave Hoefler</a> on <a href="https://unsplash.com/s/photos/pond-reflection?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a></p><h4 id=code-references>Code References</h4><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/gds/emails/client.go>Email Manager</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/gds/emails/mock.go>SendGrid mock</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/sectigo/mock/mock.go>Sectigo mock</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://github.com/trisacrypto/directory/blob/main/pkg/sectigo/sectigo_test.go>Sectigo client tests</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></div></div><div class="bg-[#E8EFF6] max-w-[800px] mx-auto mt-9 p-8 rounded-lg"><div class=text-center><h3 class="font-bold text-xl sm:text-2xl lg:text-3xl"><b class=text-[#1D65A6]>About</b>
this Post</h3></div><p class="mt-4 text-base mx-auto text-center sm:mt-5 lg:mt-7 lg:text-base max-w-2xl">A mock is a common pattern for unit testing interdependent services. In this post we will explore creating mocks in Go.</p><div class="md:flex text-base border-t pt-6 mt-6"><div><div class="text-lg text-[#1D65A6] font-bold mb-3">Written by:</div><div class="flex items-center mt-4 mb-6"><img src=img/bbfort.png alt class="border-4 border-white rounded-full h-11 drop-shadow-lg"><span class=ml-3>Patrick Deziel</span></div><div class="text-lg text-[#1D65A6] font-bold mb-3">Photo credit:</div><p></p></div><div class="sm:ml-10 sm:mt-0 mt-12"><div class="text-lg text-[#1D65A6] font-bold mb-3">Share this post:</div><ul class="grid grid-cols-2 gap-6 mt-4"><li><a href class="flex items-center"><img src=img/email.png alt class="p-3 bg-white rounded-lg mr-3"><span>info@rotational.io</span></a></li><li><a href class="flex items-center"><img src=img/github.png alt class="p-3 bg-white rounded-lg mr-3"><span>rotationalio</span></a></li><li><a href class="flex items-center"><img src=img/twitter.png alt class="p-3 bg-white rounded-lg mr-4"><span>rotationalio</span></a></li><li><a href class="flex items-center"><img src=img/linkedin.png alt class="p-3 bg-white rounded-lg mr-3"><span>rotational</span></a></li></ul></div></div></div><div class="relative max-w-7xl mx-auto px-4 sm:px-6"><div class="flex justify-between mt-12 sm:mt-24 items-center"><h2 class="font-bold text-2xl sm:text-4xl flex"><span><b class=text-[#1D65A6]>Recent</b>
Rotations</span>
<img src=img/butterfly.png alt=butterfly class="ml-4 h-6 sm:h-8 relative top-1"></h2><div><a href=/blog class="flex text-base sm:text-lg items-center font-bold text-[#1D65A6]"><span>View all</span>
<img src=img/arr-right.png alt class="h-4 ml-2"></a></div></div><div><div class="sm:grid grid-cols-3 gap-8 sm:mt-16"><div class=mt-6><div class=article><img src=https://rotational.io/img/blog/rocket.jpeg alt class=rounded-t-xl style=height:212px;width:100%><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Technologies</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/webassembly-the-future-of-computing/>Why WebAssembly Is the Future of Computing</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>If you talk about WebAssembly (WASM), you just may spark debate about whether it is really the next best thing in web development or the second coming of Java applets. In this post, we&rsquo;ll dive into WASM, how it is currently transforming web development, and why we think its future is so bright.</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/avatar.png alt class=rounded-full>
<span class="ml-4 font-extralight">Danielle Maxwell</span></div><div class=font-extralight>Sep 27, 2022</div></div></div></div></div><div class=mt-6><div class=article><img src=https://rotational.io/img/blog/herd.jpg alt class=rounded-t-xl style=height:212px;width:100%><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Crypto</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/eventing-platforms/>The Eventing Platform Landscape</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>Kafka and PubSub and Kinesis, oh my! Which eventing platform is best? In this post we&rsquo;ll explore the three primary categories of eventing systems and understand their similarities, differences, and key use cases.</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/avatar.png alt class=rounded-full>
<span class="ml-4 font-extralight">Rebecca Bilbro</span></div><div class=font-extralight>Sep 10, 2022</div></div></div></div></div><div class=mt-6><div class=article><img src=https://rotational.io/img/blog/num215.jpg alt class=rounded-t-xl style=height:212px;width:100%><div class="bg-[#ECF6FF] rounded-b-xl"><div class="px-6 pt-4"><h4 class="text-base font-bold text-[#1D65A6]">Technologies</h4><h3 class="text-xl font-extrabold mt-3"><a class="block h-24" href=https://rotational.io/blog/ranges-of-integer-data-types/>Ranges of Integer Data Types</a></h3><div class=art-s><p class="mt-3 text-base font-extralight"><p>The data type choices we make when building data systems or metrics is critically important: as our systems run for long periods of time it can be easy to overflow the integers that we use (Y2K bug anyone?). As a result, I find myself constantly checking the sizes of standard int types but I haven&rsquo;t found a good way to Google this. This blog post is a quick reference for the standard sizes and a discussion on why it matters.</p></p></div></div><div class="flex justify-between items-center px-6 py-3 border-t mt-6"><div class="flex items-center"><img src=img/avatar.png alt class=rounded-full>
<span class="ml-4 font-extralight">Benjamin Bengfort</span></div><div class=font-extralight>Sep 7, 2022</div></div></div></div></div></div></div></div></div><div class="bg-[#1D65A6] max-w-[800px] mx-auto mt-20 py-14 px-12 md:px-16 text-white md:rounded-lg"><h6 class="font-bold text-center">Enter Your Email To Subscribe</h6><input type=text placeholder class="w-full px-4 py-2.5 rounded-lg mt-6"><div class="flex mt-6 items-start"><input type=checkbox class="w-6 h-6 block border-0">
<span class="ml-2 text-left">I want to received the monthly newsletter and other updates from Rotational. You agree to your Privacy Policy. You may unsubscribe at any time.*</span></div><div class="flex justify-center"><a href class="bg-[#192E5B] px-14 py-4 mt-10 rounded-lg text-sm text-white uppercase md:text-base">Submit</a></div></div></main><footer><div class="relative pt-[90px] sm:pt-[300px] font-extralight"><img class="w-full absolute inset-y-0 left-0 lg:h-full lg:w-full lg:max-w-none" src=img/foot.png alt><div class="relative max-w-7xl mx-auto px-4 sm:px-6 bg-[#192E5B]"><div class="sm:flex text-white"><div><a href><img src=img/logo-white.png alt class="sm:h-auto h-16"></a></div><div class="sm:ml-24 mt-5 sm:mt-0 max-w-lg"><h5 class="font-bold text-lg">Contact Details</h5><p class=mt-3>We love to talk through complex scaling and performance issues. What’s slowing you down? Drop us a line for a friendly chat. We’ll make it worth your while.</p></div><div class="sm:ml-24 sm:mt-0 mt-8"><ul class="grid grid-cols-2 gap-8"><li><a href=mailto:info@rotational.io class="flex items-center" target=_blank><img src=img/email.png alt class="p-4 bg-white rounded-lg mr-4">
<span>info@rotational.io</span></a></li><li><a href=https://github.com/rotationalio class="flex items-center" target=_blank><img src=img/github.png alt class="p-4 bg-white rounded-lg mr-4">
<span>rotationalio</span></a></li><li><a href=https://twitter.com/rotationalio class="flex items-center" target=_blank><img src=img/twitter.png alt class="p-4 bg-white rounded-lg mr-4">
<span>@rotationalio</span></a></li><li><a href=https://www.linkedin.com/company/rotational class="flex items-center" target=_blank><img src=img/linkedin.png alt class="p-4 bg-white rounded-lg mr-4">
<span>Rotational</span></a></li></ul></div></div><div class="sm:flex justify-between border-t py-6 text-white mt-12 sm:mt-32"><p>Copyright © 2022 Rotational Labs, LLC · All Rights Reserved</p><ul class="sm:mt-0 mt-4 flex"><li class="border-r pr-4 mr-4"><a href>Privacy Policy</a></li><li><a href>Terms of Use</a></li></ul></div></div></div></footer><script src=https://rotational.io/js/app.js></script></body></html>